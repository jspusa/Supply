<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>è¨‚å–®åˆ†æå™¨</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    :root { font-family: "Noto Sans TC", system-ui, -apple-system, "Segoe UI", Arial, sans-serif; color: #0f1d2b; }
    body { margin: 0; padding: 32px 18px 48px; background: linear-gradient(120deg, #f6f7fb 0%, #e9f0ff 100%); }
    .page { max-width: 1200px; margin: 0 auto; }
    h1 { font-size: 22px; margin: 0 0 16px; color: #0b1624; letter-spacing: 0.4px; }
    h2 { font-size: 15px; margin: 0 0 6px; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; margin: 10px 0; }
    textarea { width: 100%; min-height: 120px; padding: 12px; font-size: 13px; line-height: 1.4; border-radius: 10px; border: 1px solid #d7deea; background: #fff; box-shadow: inset 0 1px 2px rgba(15, 29, 43, 0.03); }
    button { padding: 10px 14px; cursor: pointer; border-radius: 10px; border: 1px solid #d1d9e5; background: #0b6bcb; color: #fff; font-weight: 600; box-shadow: 0 3px 10px rgba(11, 107, 203, 0.15); transition: transform 0.05s ease, box-shadow 0.15s ease; }
    button:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(11, 107, 203, 0.25); }
    button.secondary { background: #fff; color: #0f1d2b; border-color: #d1d9e5; box-shadow: none; }
    button.secondary.active { background: #0b6bcb; color: #fff; border-color: #0b6bcb; box-shadow: 0 3px 10px rgba(11, 107, 203, 0.18); }
    label, select, input { font-size: 12px; }
    select, input[type="number"] { padding: 8px 10px; border-radius: 8px; border: 1px solid #d1d9e5; background: #fff; }
    .hint { color: #4a5565; font-size: 12px; line-height: 1.5; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 18px; }
    .card { border: 1px solid #dfe6f0; border-radius: 14px; padding: 0; background: #fff; box-shadow: 0 10px 35px rgba(17, 24, 39, 0.06); overflow: hidden; }
    .card summary { padding: 14px 16px; display: flex; justify-content: space-between; align-items: center; gap: 12px; list-style: none; cursor: pointer; user-select: none; }
    .card summary::-webkit-details-marker { display: none; }
    .card[open] summary { border-bottom: 1px solid #eef2f7; background: linear-gradient(90deg, #f7f9ff, #f0f4ff); }
    .card:not([open]) summary { background: #f9fbff; }
    .cardContent { padding: 16px; }
    .subGrid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }
    .subCard { border: 1px dashed #d9e1ee; border-radius: 10px; padding: 0; overflow: hidden; background: #fdfefe; }
    .subCard summary { padding: 12px 14px; list-style: none; cursor: pointer; display: flex; justify-content: space-between; align-items: center; gap: 8px; font-weight: 700; color: #0f1d2b; }
    .subCard summary::-webkit-details-marker { display: none; }
    .subCard[open] summary { background: #f4f7fd; border-bottom: 1px solid #e6ecf7; }
    .subCardContent { padding: 12px 14px 14px; }
    .eyebrow { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #71829e; margin: 0; }
    .pill { display:inline-block; padding:6px 10px; border:1px solid #d1d9e5; border-radius:999px; font-size:12px; color:#0f1d2b; background: #f6f9ff; }
    .tableWrap { max-height: 520px; overflow: auto; border: 1px solid #eef2f7; border-radius: 10px; background: #fbfcff; box-shadow: inset 0 1px 2px rgba(0,0,0,0.03); }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #e5ecf5; padding: 8px; font-size: 13px; }
    th { background: #f4f7fd; text-align: left; position: sticky; top: 0; color: #0f1d2b; }
    .bad { background: #fff4f4; }
    .ok  { background: #f1fbf5; }
    .warn { background: #fff8eb; }
    .count { font-weight: 600; }
    .footer { margin-top: 12px; font-size: 12px; color: #55657b; text-align: right; }
    code { background: #f4f4f4; padding: 1px 4px; border-radius: 4px; }
    .priority { border: 1px solid #c7d7f8; box-shadow: 0 10px 35px rgba(11, 107, 203, 0.08); }
    .salesChartGrid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px; margin-top: 12px; }
    .salesChartCard { border: 1px solid #e6edf7; border-radius: 12px; padding: 16px; background: #fbfdff; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6); }
    .pieRow { display: flex; flex-wrap: wrap; gap: 16px; align-items: center; }
    .pieChart { width: 180px; height: 180px; border-radius: 50%; background: #eff3fb; box-shadow: inset 0 0 0 1px #e1e8f3; position: relative; }
    .pieChart::after { content: ""; position: absolute; inset: 10px; border-radius: 50%; background: #fff; box-shadow: inset 0 0 0 1px #eef2f8; }
    .pieLegend { display: flex; flex-direction: column; gap: 8px; font-size: 12px; color: #2f3d52; }
    .legendRow { display: flex; align-items: center; gap: 8px; }
    .legendSwatch { width: 12px; height: 12px; border-radius: 4px; }
    .salesSummary { margin-top: 12px; font-size: 12px; color: #516178; line-height: 1.6; }
    .salesMissing { margin-top: 8px; font-size: 12px; color: #a04646; }

    .order-generator { margin-top: 36px; font-family: "Noto Sans TC", Arial, sans-serif; color: #273042; }
    .order-generator .container {
      margin: 36px auto 48px auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 8px 40px rgba(40,60,140,0.12);
      max-width: 1050px;
      padding: 40px 34px 30px 34px;
      position: relative;
      overflow: visible;
    }
    .order-generator .header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 28px;
      margin-bottom: 34px;
      position: relative;
    }
    .order-generator .header-bar h2 {
      color: #2c3e50;
      font-size: 2.1rem;
      font-weight: 800;
      flex: 1;
      text-align: center;
      letter-spacing: 1.2px;
      margin: 0;
      display: flex; align-items: center; justify-content: center;
      gap: 10px;
    }
    .order-generator .header-bar .fa-cube { color: #68a0fa; }
    .order-generator .factory-switch {
      background-color: #f3f7fa;
      padding: 9px 19px;
      border-radius: 9px;
      box-shadow: 0 2px 8px #e5eaf1;
      display: flex; gap: 14px;
      align-items: center;
      font-size: 1rem;
    }
    .order-generator .factory-switch label {
      margin: 0;
      color: #5682c2;
      font-weight: bold;
      cursor: pointer;
      display: flex; align-items: center;
    }
    .order-generator .factory-switch input[type="radio"] { accent-color: #3b79d5; margin-right: 5px; }

    .order-generator .box-size-button {
      background: #e9f0ff;
      color: #5682c2;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      border-radius: 7px;
      padding: 9px 20px;
      font-weight: 600;
      box-shadow: 0 2px 10px #dde8f9;
      transition: background 0.19s, color 0.19s;
      display: flex; align-items: center; gap: 8px;
    }
    .order-generator .box-size-button:hover { background: #d7e3fa; color: #3364ad;}
    .order-generator .export-button {
      background: #10b7e8;
      color: #fff;
      border: none;
      border-radius: 7px;
      padding: 11px 24px;
      font-size: 1.08rem;
      margin: 28px 0 0 0;
      font-weight: 700;
      box-shadow: 0 2px 16px #bee4f4c4;
      transition: background 0.19s;
      display: flex; align-items: center; gap: 10px;
    }
    .order-generator .export-button:hover { background: #0993b9;}

    .order-generator select,
    .order-generator input[type="number"],
    .order-generator input[type="text"] {
      width: 100%; padding: 9px 14px; margin-bottom: 16px; font-size: 1.03rem;
      border-radius: 7px; border: 1px solid #d3d9e7; box-sizing: border-box;
      transition: border .2s, box-shadow .2s;
    }
    .order-generator select:focus,
    .order-generator input[type="number"]:focus,
    .order-generator input[type="text"]:focus {
      border-color: #68a0fa;
      box-shadow: 0 0 7px #97c7f799;
      outline: none;
    }

    .order-generator .product-button {
      background: #68a0fa;
      color: #fff;
      padding: 8px 18px;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      box-shadow: 0 1px 8px #dbe7f3;
      transition: background 0.2s, color 0.2s;
      display: inline-flex; align-items: center; gap: 5px;
    }
    .order-generator .product-button:hover { background: #376fd7; }
    .order-generator .search-container { position: relative; margin-bottom: 22px; }
    .order-generator .search-input {
      width: 100%; padding: 10px 14px; font-size: 1rem; box-sizing: border-box;
      border-radius: 7px; border: 1.5px solid #c2d7ef; margin-bottom: 0;
    }
    .order-generator .search-results {
      position: absolute; top: 45px; left: 0; width: 100%; background-color: #fff;
      border: 1px solid #c9d8ef; border-top: none; max-height: 180px;
      overflow-y: auto; z-index: 100;
      border-radius: 0 0 7px 7px;
      box-shadow: 0 8px 16px #97b5e733;
    }
    .order-generator .search-result-item {
      padding: 9px 14px; cursor: pointer; font-size: 1rem; color: #304976;
      transition: background 0.15s;
    }
    .order-generator .search-result-item:hover {
      background: #eef4fd;
      color: #1b2f50;
    }
    .order-generator .table-responsive { overflow-x: auto; }
    .order-generator table {
      width: 100%; margin-top: 12px; border-collapse: separate; border-spacing: 0;
      background: #fafdff;
      border-radius: 12px;
      box-shadow: 0 1px 16px #dbe8fa60;
      overflow: hidden;
    }
    .order-generator th, .order-generator td {
      padding: 14px 8px;
      border-bottom: 1px solid #e3e8f0;
      font-size: 1.01rem;
    }
    .order-generator th {
      background: #eaf1fc;
      color: #375a7f;
      font-weight: 700;
      border-bottom: 2px solid #b7d2f6;
    }
    .order-generator tr:last-child td { border-bottom: none; }
    .order-generator tr:hover td { background: #f0f5fe; }
    .order-generator .action-button, .order-generator .remove-button, .order-generator .lock-button {
      background: #e0e7f3; color: #5c6f8f;
      padding: 5px 9px; margin: 2px 1px;
      border: none; border-radius: 6px; cursor: pointer;
      font-size: 15px; font-weight: bold;
      transition: background 0.2s;
    }
    .order-generator .action-button:hover { background: #b0c9e7;}
    .order-generator .remove-button { background: #fa7878; color: #fff;}
    .order-generator .remove-button:hover { background: #e84242;}
    .order-generator .lock-button { background: #ffd76b; color: #925700;}
    .order-generator .lock-button:hover { background: #ffe091;}
    .order-generator .locked td { background: #f7f7fa; }
    .order-generator .totals-container { text-align: right; margin-top: 24px;}
    .order-generator .total {
      font-weight: 700; font-size: 1.08rem; margin-bottom: 2px;
    }
    .order-generator .box-counts { margin-top: 3px; font-size: 1rem; color: #6679a8; text-align:right;}
    .order-generator .container-info { margin: 22px 0 12px 0; }
    .order-generator .progress-container {
      width: 100%; background: #e3eaf8; border-radius: 8px; margin: 10px 0;
      position: relative; height: 23px;
    }
    .order-generator .progress-bar {
      height: 100%; border-radius: 8px; width: 0%; text-align: center;
      color: white; line-height: 23px; font-weight: bold; background: linear-gradient(90deg,#3fb7fd 40%,#5ccfb1 100%);
      transition: width 0.35s;
      font-size: 1rem;
      letter-spacing: 0.1em;
    }
    .order-generator .generator-hint {
      text-align: right;
      font-size: 0.95rem;
      color: #7284aa;
      margin: 14px 0 0;
    }
    /* å½ˆçª— */
    .order-generator .modal {
      display: none; position: fixed; z-index: 2000; left: 0; top: 0;
      width: 100%; height: 100%; overflow: auto;
      background: rgba(0,0,0,0.16);
      animation: fadeIn .3s;
    }
    @keyframes fadeIn {
      from {opacity: 0;} to {opacity: 1;}
    }
    .order-generator .modal-content {
      background: #fff; margin: 6% auto; padding: 30px 26px; border-radius: 16px;
      width: 92%; max-width: 470px; position: relative;
      box-shadow: 0 12px 48px #5664ff40;
      animation: modalPopIn .34s;
    }
    @keyframes modalPopIn {
      from {transform: scale(0.9);}
      to {transform: scale(1);}
    }
    .order-generator .close-modal {
      color: #aab2c6; font-size: 32px; font-weight: bold; cursor: pointer;
      position: absolute; right: 20px; top: 10px;
      transition: color 0.18s;
    }
    .order-generator .close-modal:hover, .order-generator .close-modal:focus { color: #222; }
    .order-generator .modal-content p { margin: 12px 0 6px 0; }
    /* æ–°å“ç”¢ç”Ÿå™¨æµ®å‹•éˆ• */
    .order-generator #newItemGeneratorBtn {
      position: fixed; top: 22px; right: 30px;
      background: linear-gradient(120deg,#10b7e8 60%,#7ad0e0 100%);
      color: #fff; border: none; border-radius: 50%; width: 45px; height: 45px;
      cursor: pointer; font-weight: bold; font-size: 2rem;
      box-shadow: 0 2px 14px #13e6f442;
      display: flex; align-items: center; justify-content: center;
      z-index: 2100;
      transition: box-shadow 0.2s, background 0.2s;
    }
    .order-generator #newItemGeneratorBtn:hover { box-shadow: 0 4px 24px #23baff74; background: #0aa2c3; }
    .order-generator #discontinuedListBtn {
      position: fixed; top: 22px; right: 86px;
      background: linear-gradient(120deg,#ff6b6b 60%,#ff9a9a 100%);
      color: #fff; border: none; border-radius: 50%; width: 40px; height: 40px;
      cursor: pointer; font-weight: bold; font-size: 1.1rem;
      box-shadow: 0 2px 12px rgba(255, 107, 107, 0.35);
      display: flex; align-items: center; justify-content: center;
      z-index: 2100;
      transition: box-shadow 0.2s, background 0.2s;
    }
    .order-generator #discontinuedListBtn:hover {
      box-shadow: 0 4px 20px rgba(255, 107, 107, 0.5);
      background: #ff5252;
    }
    .discontinued-text { color: #c62828; font-weight: 700; }
    .discontinued-tag {
      display: inline-block; margin-left: 6px; padding: 2px 7px;
      border-radius: 999px; font-size: 11px; font-weight: 700;
      background: #ffe5e5; color: #c62828; border: 1px solid #f2b3b3;
    }
    .hot-text { color: #b45309; font-weight: 700; }
    .hot-tag {
      display: inline-block; margin-left: 6px; padding: 2px 7px;
      border-radius: 999px; font-size: 11px; font-weight: 700;
      background: #fff1d6; color: #b45309; border: 1px solid #ffd59a;
    }
    .discontinued-list-wrap { max-height: 380px; overflow: auto; }
    /* user-tipæç¤º */
    .order-generator .user-tip {
      position: fixed; left: 50%; bottom: 44px; transform: translateX(-50%);
      background: #384b65d7; color: #fff; padding: 17px 36px;
      border-radius: 13px; font-size: 1.08rem; z-index: 3500;
      box-shadow: 0 2px 16px #0002; opacity: 1; transition: opacity 0.4s;
    }
    .order-generator .user-tip.error { background: #e63946d7;}
    .order-generator .user-tip.success { background: #37be6dd7;}
    /* éŸ¿æ‡‰å¼ */
    @media (max-width: 1150px) {
      .order-generator .container { padding: 22px 8px;}
    }
    @media (max-width: 600px) {
      .order-generator .container {padding: 9px;}
      .order-generator .header-bar h2 { font-size: 1.1rem;}
      .order-generator .modal-content {padding: 14px 6px;}
      .order-generator .product-button{font-size: .9rem;}
    }
  </style>
</head>
<body>
  <div class="page">
    <h1>è¨‚å–®åˆ†æå™¨</h1>

    <div class="row">
      <button id="btnBuild">æ•´ç†è¡¨æ ¼</button>
    </div>

    <div class="row">
      <label>å·¥å» ç¯©é¸ï¼š</label>
      <select id="factoryFilter">
        <option value="all">é¡¯ç¤ºå…¨éƒ¨</option>
        <option value="hideTW">è¶Šå—å» </option>
        <option value="onlyTW">å°ç£å» </option>
      </select>
      <label>å“é …ç¯©é¸ï¼š</label>
      <select id="itemFilter">
        <option value="all">é¡¯ç¤ºå…¨éƒ¨</option>
        <option value="onlyNonTurkey">éç«é›ç­‹</option>
        <option value="onlyTurkey">ç«é›ç­‹</option>
      </select>
    </div>

    <div class="row">
      <label>ä¸‹å–®é–€æª»ï¼ˆå¤©ï¼‰ï¼š</label>
      <input id="daysThreshold" type="number" min="1" step="1" value="180" />
    </div>

    <div class="grid">
      <details class="card" open>
        <summary>
          <div>
            <p class="eyebrow">è³‡æ–™è¼¸å…¥å€</p>
            <h2>è²¼ä¸Šä¾†æºè³‡æ–™</h2>
            <div class="hint">ç›´æ¥è²¼ raw æ–‡å­—å³å¯ï¼Œç³»çµ±æœƒè‡ªå‹•è§£æ SKU / ASIN / æ•¸é‡ã€‚</div>
          </div>
          <span class="pill">å¯æ”¶åˆ</span>
        </summary>
        <div class="cardContent">
          <section class="order-generator">
            <div class="container">
              <div class="header-bar">
                <div class="factory-switch">
                  <label><input type="radio" name="countrySelect" value="VN" checked> è¶Šå—å» </label>
                  <label><input type="radio" name="countrySelect" value="TW"> å°ç£å» </label>
                  <label><input type="radio" name="countrySelect" value="Others"> å…¶ä»–</label>
                </div>
                <h2>
                  <i class="fa-solid fa-cube"></i> è¨‚å–®ç”¢ç”Ÿå™¨
                  <span style="font-size: 1rem; color:#8ab2e0; margin-left:12px;font-weight:400;">Order Generator</span>
                </h2>
                <button class="box-size-button" onclick="openModal()">
                  <i class="fa-solid fa-ruler-combined"></i> ç´™ç®±å°ºå¯¸
                </button>
              </div>
              <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="ğŸ” ä»¥å“è™Ÿæœå°‹/å¿«é€ŸåŠ å…¥" oninput="searchProduct()">
                <div id="searchResults" class="search-results"></div>
              </div>
              <div class="table-responsive">
                <table id="productTable">
                  <thead>
                    <tr>
                      <th>åºè™Ÿ</th>
                      <th>å“è™Ÿ</th>
                      <th>åŒ…æ•¸</th>
                      <th>è¢‹æ•¸/ç›’æ•¸</th>
                      <th>ç›®æ¨™æ•¸é‡</th>
                      <th>ç®±æ•¸</th>
                      <th>æ£§æ¿æ•¸</th>
                      <th>ç´™ç®±å°ºå¯¸ (cm)</th>
                      <th>æ¯æ£§æ¿å¯å”®å¤©æ•¸</th>
                      <th>é è¨ˆéŠ·å”®å¤©æ•¸</th>
                      <th>æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="generator-hint">
                å¯å”®å¤©æ•¸ä»¥ H10 é€Ÿåº¦è¨ˆç®—ï¼šæœ‰è¢‹/ç›’æ™‚å…ˆç”¨è¢‹/ç›’é€Ÿåº¦ï¼Œç„¡è¢‹/ç›’æ‰ç”¨åŒ…æ•¸é€Ÿåº¦ã€‚
              </div>
              <div class="totals-container">
                <div class="total">
                  <i class="fa-solid fa-boxes-stacked"></i>
                  ç¸½åŒ…æ•¸: <span id="totalQuantity">0</span> |
                  ç¸½ç®±æ•¸: <span id="totalCartons">0</span> |
                  ç¸½æ£§æ¿æ•¸: <span id="totalPallets">0</span>
                </div>
                <div class="box-counts" id="boxCounts"></div>
              </div>
              <div id="containerInfo" class="container-info"></div>
              <button class="export-button" onclick="exportToExcel()">
                <i class="fa-solid fa-file-arrow-down"></i> åŒ¯å‡º Excel
              </button>
            </div>

            <!-- ç´™ç®±è¦æ ¼ Modal -->
            <div id="boxSizeModal" class="modal">
              <div class="modal-content">
                <span class="close-modal" onclick="closeModal()">&times;</span>
                <h2 style="color:#3777eb;font-size:1.25rem;margin-bottom:16px;">
                  <i class="fa-solid fa-ruler-combined"></i> ç´™ç®±å¸¸ç”¨å°ºå¯¸
                </h2>
                <div style="font-size:1.06rem;line-height:1.8;">
                  <p><b>50Ã—40Ã—30 cm</b>ï¼ˆ20Ã—16Ã—12 inï¼‰</p>
                  <p><b>58.5Ã—34.5Ã—35 cm</b>ï¼ˆ23Ã—14Ã—14 inï¼‰</p>
                  <p><b>50Ã—40Ã—40 cm</b>ï¼ˆ20Ã—16Ã—16 inï¼‰</p>
                  <p><b>48Ã—38Ã—28 cm</b>ï¼ˆ19Ã—15Ã—11 inï¼‰<strong> (ä¸­ä¸‰ç®±)</strong></p>
                  <p style="color:#5974b6;">ä¹Ÿå¯æ–¼æ–°å“ç”¢ç”Ÿå™¨ã€Œè‡ªè¨‚ã€å…¶ä»–å°ºå¯¸</p>
                </div>
              </div>
            </div>

            <!-- æ–°å“ç”¢ç”Ÿå™¨æµ®å‹•æŒ‰éˆ• -->
            <button id="newItemGeneratorBtn" title="æ–°å“ç”¢ç”Ÿå™¨">
              <i class="fa-solid fa-plus"></i>
            </button>
            <!-- åœç”¢æ¸…å–®æµ®å‹•æŒ‰éˆ• -->
            <button id="discontinuedListBtn" title="åœç”¢æ¸…å–®">
              <i class="fa-solid fa-ban"></i>
            </button>
            <!-- åœç”¢æ¸…å–® Modal -->
            <div id="discontinuedModal" class="modal">
              <div class="modal-content">
                <span class="close-modal" onclick="closeDiscontinuedModal()">&times;</span>
                <h2 style="color:#e53935;font-size:1.25rem;margin-bottom:16px;">
                  <i class="fa-solid fa-ban"></i> åœç”¢æ¸…å–®
                </h2>
                <div class="tableWrap discontinued-list-wrap">
                  <table>
                    <thead>
                      <tr>
                        <th>å“è™Ÿ</th>
                        <th>åœç”¢ç†ç”±</th>
                      </tr>
                    </thead>
                    <tbody id="discontinuedListBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
            <!-- æ–°å“ç”¢ç”Ÿå™¨ Modal -->
            <div id="newItemModal" class="modal">
              <div class="modal-content">
                <span class="close-modal" onclick="closeNewItemModal()">&times;</span>
                <h2 style="color:#3376ed"><i class="fa-solid fa-cube"></i> æ–°å“ç”¢ç”Ÿå™¨</h2>
                <div style="font-size:0.97rem;color:#3d5c90;margin-bottom:12px;">
                  ä¾åºè¼¸å…¥æ–°å•†å“è³‡è¨Šï¼Œ<span style="color:#eb3d3d;">* å¿…å¡«</span>
                </div>
                <label>å“è™Ÿ <span style="color:#eb3d3d">*</span>
                  <input type="text" id="newItemCode" placeholder="å¿…å¡« (å¦‚ AFA11AM)">
                </label>
                <label>å“å <span style="color:#eb3d3d">*</span>
                  <input type="text" id="newItemName" placeholder="å¿…å¡«">
                </label>
                <label>ç´™ç®±å°ºå¯¸ <span style="color:#eb3d3d">*</span>
                  <select id="newItemBoxSize" onchange="boxSizeChanged()">
                    <option value="50*40*30">50Ã—40Ã—30cm (20Ã—16Ã—12in)</option>
                    <option value="58.5*34.5*35">58.5Ã—34.5Ã—35cm (23Ã—14Ã—14in)</option>
                    <option value="50*40*40">50Ã—40Ã—40cm (20Ã—16Ã—16in)</option>
                    <option value="48*38*28">48Ã—38Ã—28cm (19Ã—15Ã—11in) (ä¸­ä¸‰ç®±)</option>
                    <option value="">è‡ªè¨‚...</option>
                  </select>
                  <input type="text" id="newItemBoxSizeCustom" placeholder="è¼¸å…¥å°ºå¯¸, ä¾‹50*40*30" style="display:none;">
                </label>
                <label>æ£§æ¿ç®±æ•¸ <span style="color:#eb3d3d">*</span>
                  <input type="number" id="newItemPallet" placeholder="è‡ªå‹•å¸¶å…¥ï¼Œå¯ä¿®æ”¹">
                </label>
                <label>ç”Ÿç”¢åœ‹åˆ¥
                  <select id="newItemCountry">
                    <option value="VN">VN (è¶Šå—)</option>
                    <option value="TW">TW (å°ç£)</option>
                    <option value="Others">Others</option>
                  </select>
                </label>
                <label>åŒ…è£é¡å‹
                  <select id="newItemPackagingType" onchange="packagingTypeChanged()">
                    <option value="single">å–®åŒ…</option>
                    <option value="bag">è¢‹è£</option>
                    <option value="box">ç›’è£</option>
                  </select>
                </label>
                <div id="packagingFields"></div>
                <button class="product-button" style="background:#3a7afe;" onclick="addNewItemLine()">
                  <i class="fa-solid fa-cart-plus"></i> åŠ å…¥
                </button>
                <hr>
                <div style="font-size:.95rem;color:#8895b1;margin-bottom:6px;">çµæœï¼ˆå¯è¤‡è£½çµ¦å·¥ç¨‹å¸«ï¼‰ï¼š</div>
                <textarea id="newItemResult" style="width:100%;height:80px;background:#f6f7fa;border-radius:8px;border:1px solid #d1dae4;padding:8px 11px;font-size:.96rem;"></textarea>
                <button class="product-button" style="background:#23c87d;" onclick="copyNewItems()">
                  <i class="fa-solid fa-copy"></i> è¤‡è£½çµæœ
                </button>
              </div>
            </div>
          </section>
          <div class="subGrid">
            <details class="subCard" open>
              <summary>Helium 10 åŸå§‹æ–‡å­—</summary>
              <div class="subCardContent">
                <div class="hint">æŠ“å– <code>ASIN(10ç¢¼)</code> + å¾Œé¢çš„ <code>SKU</code>ï¼Œå†å–ç¬¬ä¸€å€‹æ•¸å­—ä½œç‚ºé€Ÿåº¦ã€‚</div>
                <textarea id="inputH10" placeholder="è²¼ Helium 10 å…§å®¹..."></textarea>
              </div>
            </details>
            <details class="subCard" open>
              <summary>è¨‚å–®æ¸…å–®</summary>
              <div class="subCardContent">
                <div class="hint">Tab/ç©ºç™½çš†å¯ã€‚æ¯è¡Œç¬¬ 1 æ¬„æ˜¯ SKUï¼›æ•¸é‡åªå¾ã€ŒSKU å¾Œé¢æ¬„ä½ã€æŠ“æ•¸å­—ã€‚é‡è¤‡ SKU æœƒåŠ ç¸½ã€‚</div>
                <textarea id="inputOrders" placeholder="ä¾‹å¦‚ï¼š
AFA11AM	5040
AFA12AM	27360
TTS05AM-1	170100
..."></textarea>
              </div>
            </details>
            <details class="subCard" open>
              <summary>ç¾åœ‹ç¸½æ•¸</summary>
              <div class="subCardContent">
                <div class="hint">Tab/ç©ºç™½çš†å¯ã€‚æ¯è¡Œç¬¬ 1 æ¬„æ˜¯ SKUï¼›æ•¸é‡åªå¾ã€ŒSKU å¾Œé¢æ¬„ä½ã€æŠ“æ•¸å­—ã€‚é‡è¤‡ SKU æœƒåŠ ç¸½ã€‚</div>
                <textarea id="inputUS" placeholder="ä¾‹å¦‚ï¼š
TTS05AM-1 57223
TTR01AM-4 14125
..."></textarea>
              </div>
            </details>
          </div>
        </div>
      </details>

      <!-- 180å¤©å…§æ¸…å–® -->
      <details class="card priority" open>
        <summary>
          <div>
            <p class="eyebrow">é‡é»æª¢è¦– â‘ </p>
            <h2>é–€æª»å…§å¯å”®å“é …ï¼šå»ºè­°ä¸‹å–®æ¸…å–®</h2>
            <div class="hint">åªæŠ“ã€Œå¯éŠ·å”®å¤©æ•¸ &lt;= é–€æª»ã€ä¸”é€Ÿåº¦ &gt; 0 çš„ SKU</div>
          </div>
          <div class="hint">
            ç­†æ•¸ï¼š<span class="count" id="countReorder">0</span>
          </div>
        </summary>

        <div class="cardContent">
          <div class="row">
            <button class="secondary" id="btnDownloadReorderCSV">ä¸‹è¼‰ä¸‹å–®æ¸…å–® CSV</button>
            <button class="secondary" id="btnAddReorderToGenerator">ä¸€éµåŠ å…¥è¨‚å–®ç”¢ç”Ÿå™¨</button>
          </div>

          <div class="tableWrap" id="reorderTableWrap"></div>
        </div>
      </details>

      <!-- ä¸»è¡¨ -->
      <details class="card priority" open>
        <summary>
          <div>
            <p class="eyebrow">é‡é»æª¢è¦– â‘¡</p>
            <h2>ä¸»è¡¨ï¼ˆH10 ç”¢å“ï¼‰</h2>
            <div class="hint">SKU / é€Ÿåº¦ / è¨‚å–® / ç¾åœ‹ç¸½æ•¸ / å¯éŠ·å”®å¤©æ•¸</div>
          </div>
        </summary>

        <div class="cardContent">
          <div class="row">
    <button class="secondary" id="btnDownloadMainCSV">ä¸‹è¼‰ä¸»è¡¨ Excel</button>
            <div class="row" style="margin:0;">
              <span class="hint">ä¸»è¡¨æ’åºï¼š</span>
              <button class="secondary" id="btnSortSpeed">é€Ÿåº¦ç”±å¤§åˆ°å°</button>
              <button class="secondary" id="btnSortDays">å¯éŠ·å”®å¤©æ•¸ç”±å°åˆ°å¤§</button>
            </div>
          </div>

          <div class="tableWrap" id="mainTableWrap"></div>
        </div>
      </details>

      <!-- ç†±éŠ·å“å°ˆå€ -->
      <details class="card priority" open>
        <summary>
          <div>
            <p class="eyebrow">é‡é»æª¢è¦– â‘¢</p>
            <h2>ç†±éŠ·å“å°ˆå€</h2>
            <div class="hint">SKU / é€Ÿåº¦ / è¨‚å–® / ç¾åœ‹ç¸½æ•¸ / å¯éŠ·å”®å¤©æ•¸</div>
          </div>
          <div class="hint">
            ç­†æ•¸ï¼š<span class="count" id="countHot">0</span>
          </div>
        </summary>

        <div class="cardContent">
          <div class="row">
            <button class="secondary" id="btnAddHotToGenerator">ä¸€éµåŠ å…¥è¨‚å–®ç”¢ç”Ÿå™¨</button>
          </div>

          <div class="tableWrap" id="hotTableWrap"></div>
        </div>
      </details>

      <!-- æ–°å“ï¼ˆè¨‚å–®æœ‰ä½†H10æ²’æœ‰ï¼‰ -->
      <details class="card priority" open>
        <summary>
          <div>
            <p class="eyebrow">é‡é»æª¢è¦– â‘£</p>
            <h2>æ–°å“ï¼ˆè¨‚å–®æœ‰ï¼Œä½† H10 æ²’æœ‰ï¼‰</h2>
            <div class="hint">SKU / è¨‚å–® / ç¾åœ‹ç¸½æ•¸(è‹¥æœ‰)</div>
          </div>
          <div class="hint">
            ç­†æ•¸ï¼š<span class="count" id="countNewOrder">0</span>
          </div>
        </summary>

        <div class="cardContent">
          <div class="row">
            <button class="secondary" id="btnDownloadNewOrderCSV">ä¸‹è¼‰æ–°å“(è¨‚å–®) CSV</button>
          </div>

          <div class="tableWrap" id="newOrderWrap"></div>
        </div>
      </details>

      <!-- æ–°å“ï¼ˆç¾åœ‹ç¸½æ•¸æœ‰ä½†H10æ²’æœ‰ä¸”è¨‚å–®ä¹Ÿæ²’æœ‰ï¼‰ é è¨­æ”¶æŠ˜ -->
      <details class="card" id="newUSDetails">
        <summary>
          <div>
            <p class="eyebrow">å…¶ä»–</p>
            <h2 style="margin:0;">ç¾åœ‹ç¸½æ•¸æœ‰ï¼Œä½† H10 æ²’æœ‰ï¼Œä¸”è¨‚å–®ä¹Ÿæ²’æœ‰</h2>
          </div>
          <span class="hint">ï¼ˆé è¨­æ”¶æŠ˜ï¼Œé»æ­¤å±•é–‹ï¼‰</span>
        </summary>

        <div class="cardContent">
          <div class="row" style="justify-content: space-between;">
            <div class="hint">SKU / ç¾åœ‹ç¸½æ•¸</div>
            <div class="hint">
              ç­†æ•¸ï¼š<span class="count" id="countNewUS">0</span>
            </div>
          </div>

          <div class="row">
            <button class="secondary" id="btnDownloadNewUSCSV">ä¸‹è¼‰æ–°å“(ç¾åœ‹ç¸½æ•¸) CSV</button>
          </div>

          <div class="tableWrap" id="newUSWrap"></div>
        </div>
      </details>
    </div>

    <details class="card" id="advancedSettings">
      <summary>
        <div>
          <p class="eyebrow">è¨­å®š</p>
          <h2>é€²éšè¨­å®šï¼ˆå¯å±•é–‹ï¼‰</h2>
        </div>
        <span class="pill">å¯æ”¶åˆ</span>
      </summary>
      <div class="cardContent">
        <div class="row">
          <label style="display:flex; gap:6px; align-items:center;">
            <input type="checkbox" id="chkDedupe" checked />
            H10 å»é‡ï¼ˆä»¥ ASIN+SKUï¼‰
          </label>
          <label style="display:flex; gap:6px; align-items:center;">
            <input type="checkbox" id="chkMissingOrderAsZero" checked />
            H10 æ‰¾ä¸åˆ°è¨‚å–®æ™‚å¡« 0
          </label>
          <label style="display:flex; gap:6px; align-items:center;">
            <input type="checkbox" id="chkMissingUsAsBlank" />
            H10 æ‰¾ä¸åˆ°ç¾åœ‹ç¸½æ•¸æ™‚ç•™ç©ºï¼ˆä¸å‹¾é¸å‰‡å¡« 0ï¼‰
          </label>
          <label style="display:flex; gap:6px; align-items:center;">
            <input type="checkbox" id="chkNormalizeSku" checked />
            SKU æ­£è¦åŒ–ï¼ˆå»ç©ºç™½ã€è½‰å¤§å¯«ï¼‰
          </label>
        </div>
      </div>
    </details>

    <details class="card" id="salesPieDetails">
      <summary>
        <div>
          <p class="eyebrow">éŠ·å”®é¡åˆ†æ</p>
          <h2>éŠ·å”®é¡åœ“é¤…åœ–</h2>
          <div class="hint">è²¼ä¸Šã€ŒSKU + è¨‚è³¼ç”¢å“éŠ·å”®é¡ã€è³‡æ–™ï¼Œç³»çµ±æœƒä¾å·¥å» èˆ‡å“é …åˆ†é¡ç”¢ç”Ÿåœ“é¤…åœ–ã€‚</div>
        </div>
        <span class="pill">å¯æ”¶åˆ</span>
      </summary>
      <div class="cardContent">
        <div class="row">
          <textarea id="salesInput" placeholder="SKU&#9;è¨‚è³¼ç”¢å“éŠ·å”®é¡&#10;TTS05AM-1&#9;US$366,151.00"></textarea>
        </div>
        <div class="row">
          <button id="btnBuildSalesCharts" class="secondary">ç”¢ç”Ÿåœ“é¤…åœ–</button>
          <span class="hint">å¯ç›´æ¥è²¼ä¸Šæ•´æ®µè³‡æ–™ï¼ˆå«æ¨™é¡Œè¡Œï¼‰ï¼Œæ”¯æ´ US$ é‡‘é¡æ ¼å¼ã€‚</span>
        </div>
        <div class="salesChartGrid">
          <div class="salesChartCard">
            <p class="eyebrow">å·¥å» ç¯©é¸</p>
            <h2>å°ç£å»  vs è¶Šå—å» </h2>
            <div class="pieRow">
              <div class="pieChart" id="factoryPie"></div>
              <div class="pieLegend" id="factoryLegend"></div>
            </div>
          </div>
          <div class="salesChartCard">
            <p class="eyebrow">å“é …ç¯©é¸</p>
            <h2>ç«é›ç­‹ vs éç«é›ç­‹</h2>
            <div class="pieRow">
              <div class="pieChart" id="itemPie"></div>
              <div class="pieLegend" id="itemLegend"></div>
            </div>
          </div>
        </div>
        <div class="salesSummary" id="salesSummary"></div>
        <div class="salesMissing" id="salesMissing"></div>
      </div>
    </details>

    <div class="footer">
      è¨»ï¼šé€Ÿåº¦ç‚º 0 æˆ–æŠ“ä¸åˆ°é€Ÿåº¦ â†’ ä¸è¨ˆç®—å¯éŠ·å”®å¤©æ•¸ï¼Œä¸”ä¸æœƒé€²å…¥ã€Œä¸‹å–®æ¸…å–®ã€ã€‚
    </div>

  </div>

  <!-- xlsx -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

<script>
const discontinuedSkuDefaults = [
  "HDP01AM","ATR03","HDS03AM","VTB05-1","TTR05AM-1","VTB06-4","TPZL05","ATP05","ATZ03","ADT03",
  "ATB03","TPZL01","GTT03","TPZ01AM-4","TRP05AM","TTRL05","TRP01AM-4","TTRL03","GBB01",
  "ATN01","1ABRD001A0","GBS01","GBS03","1ABRD003A0","ASA01","ABM01","ATJ01","ACTL05","ASCL03",
  "ACTL08","ACA01","ACA02","ACA03","VBW01","VBS03","VBB01","VBS01","TTR05AM","HDR01AM","GTC01",
  "GCTL05","GCTL02","ATJL01"
];
const discontinuedSkuReasons = new Map(
  discontinuedSkuDefaults.map(sku => [sku, "éŠ·é‡ä¸ä½³"])
);
["1ABRD001A0","1ABRD003A0","GTC01","ASA01","ATN01","ABM01"].forEach(sku => {
  discontinuedSkuReasons.set(sku, "å–æ¶ˆå°åŒ…");
});
["ATJ01","ATJL01"].forEach(sku => {
  discontinuedSkuReasons.set(sku, "åŸæ–™å› ç´ ");
});
const discontinuedSkuSet = new Set(discontinuedSkuReasons.keys());
function normalizeSkuKey(sku) {
  return String(sku ?? "").trim().toUpperCase();
}
function isDiscontinuedSku(sku) {
  return discontinuedSkuSet.has(normalizeSkuKey(sku));
}
function getDiscontinuedReason(sku) {
  return discontinuedSkuReasons.get(normalizeSkuKey(sku)) || "";
}

const hotSkuList = [
  "TTS05AM-1",
  "TTSL05",
  "TTS05AM",
  "AFA12AM",
  "GTSL01",
  "GTB01",
  "GTS01",
  "GTB05",
  "TTR01AM",
  "AFA11AM",
  "GTBL05",
  "KTB01AM-4",
  "KTBL05",
  "KTB05AM-1",
  "VTS01-1",
  "GCBL02",
  "KTB01AM",
  "ATA01",
  "KTB05AM",
  "AFA22AM",
  "GBSL03",
  "GSFL02",
  "GTRL01",
  "ASF01",
  "GTPL03",
  "GSCL01",
  "ACBL03",
  "1ABRD004A0",
  "ASCL01"
];
const hotSkuSet = new Set(hotSkuList.map(sku => normalizeSkuKey(sku)));
function isHotSku(sku) {
  return hotSkuSet.has(normalizeSkuKey(sku));
}

(() => {
  const h10El = document.getElementById('inputH10');
  const ordersEl = document.getElementById('inputOrders');
  const usEl = document.getElementById('inputUS');

  const chkDedupe = document.getElementById('chkDedupe');
  const chkMissingOrderAsZero = document.getElementById('chkMissingOrderAsZero');
  const chkMissingUsAsBlank = document.getElementById('chkMissingUsAsBlank');
  const chkNormalizeSku = document.getElementById('chkNormalizeSku');

  const daysThresholdEl = document.getElementById('daysThreshold');
  const factoryFilterEl = document.getElementById('factoryFilter');
  const itemFilterEl = document.getElementById('itemFilter');
  const btnSortSpeed = document.getElementById('btnSortSpeed');
  const btnSortDays = document.getElementById('btnSortDays');

  const mainWrap = document.getElementById('mainTableWrap');
  const reorderWrap = document.getElementById('reorderTableWrap');
  const hotWrap = document.getElementById('hotTableWrap');
  const newOrderWrap = document.getElementById('newOrderWrap');
  const newUSWrap = document.getElementById('newUSWrap');

  const countReorderEl = document.getElementById('countReorder');
  const countHotEl = document.getElementById('countHot');
  const countNewOrderEl = document.getElementById('countNewOrder');
  const countNewUSEl = document.getElementById('countNewUS');

  const newUSDetails = document.getElementById('newUSDetails');

  // å·¥å» ç¯©é¸ç‹€æ…‹ï¼šall | hideTW | onlyTW
  let factoryMode = "all";
  let itemFilterMode = "all";
  let sortMode = "normal";

  const nonTurkeySkuSet = new Set(`
    AFA13AM AFA14AM
    AFA21AM AFA22AM AFA25AM AFA135AM
    GTS01 GTR01 GTB01 GTP01 GTZ01 GTA01 GTC01
    GTB03 GTR03 GTP03 GTS03 GTZ03
    GTB05 GTP05 GTB07
    GSF01 GSF02
    GTSL01 GTRL01 GTPL01 GTBL01 GTAL01 GTCL01
    GTRL03 GTPL03 GTBL03 GTZL03
    GTPL05 GTBL05
    GSFL01 GSFL02
    ATS01 ATB01 ATR01AM ATP01 ATZ01
    ATR01
    ATB03 ATR03 ATP03 ATZ03
    ATB05 ATP05 ATA01 ATAL01
    KTB01AM TRP01AM TTR01AM TPZ01AM
    KTB03AM TRP03AM TTR03AM TPZ03AM
    TRP05AM KTB05AM TTR05AM TPZ05AM TTS05AM
    KTB06AM
    KTB01AM-4 TTR01AM-4 TRP01AM-4 TPZ01AM-4
    KTB03AM-2 TRP03AM-2 TTR03AM-2 TPZ03AM-2
    KTB05AM-1 TRP05AM-1 TTR05AM-1 TPZ05AM-1 TTS05AM-1
    KTB06AM-4
    KTBL01 TTRL01 TPZL01 TRPL01
    KTBL03 TTRL03 TPZL03 TRPL03
    TTRL05 TRPL05 TPZL05 KTBL05 TTSL05
    AFML01 AFML03 AFML05
    GTT01 GTT03
    VTS01-1 VTB01-4 VTR01-4 VTB05-1 VTB06-4
    HDR01AM HDP01AM HDS03AM
  `.trim().split(/\s+/).filter(Boolean).map(s => s.trim().toUpperCase()));
  window.turkeySkuSet = nonTurkeySkuSet;

  /** @type {{sku:string, asin:string, speed:(number|null), order:(number|null), us:(number|null), avail:(number|null), days:(number|null)}[]} */
  let mainRowsAll = [];
  /** @type {{sku:string, asin:string, speed:number, order:number, us:number, avail:number, days:number}[]} */
  let reorderRowsAll = [];
  /** @type {{sku:string, asin:(string|null), speed:(number|null), order:(number|null), us:(number|null), avail:(number|null), days:(number|null)}[]} */
  let hotRowsAll = [];
  /** @type {{sku:string, order:number, us:(number|null)}[]} */
  let newOrderRowsAll = [];
  /** @type {{sku:string, us:number}[]} */
  let newUSRowsAll = [];

  function escapeHtml(s) {
    return (s ?? "").replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }
  function renderSkuCell(sku) {
    const isDiscontinued = isDiscontinuedSku(sku);
    const isHot = isHotSku(sku);
    const label = escapeHtml(sku);
    const tags = [
      isHot ? ' <span class="hot-tag">ç†±éŠ·å“</span>' : '',
      isDiscontinued ? ' <span class="discontinued-tag">åœç”¢</span>' : ''
    ].join('');
    const className = [
      isHot ? 'hot-text' : '',
      isDiscontinued ? 'discontinued-text' : ''
    ].filter(Boolean).join(' ');
    return `<td class="${className}">${label}${tags}</td>`;
  }
  function normalizeNumber(s) {
    if (s === null || s === undefined) return null;
    const cleaned = String(s).replace(/,/g, '');
    const n = Number(cleaned);
    return Number.isFinite(n) ? n : null;
  }
  function normalizeSku(sku) {
    if (!chkNormalizeSku.checked) return String(sku ?? "");
    return String(sku ?? "").trim().toUpperCase();
  }
  function normalizeSkuValue(sku) {
    return String(sku ?? "").trim().toUpperCase();
  }
  function fmtDays(n) {
    if (n === null || n === undefined) return "";
    return (Math.round(n * 10) / 10).toFixed(1);
  }
  function isTaiwanFactorySKU(sku) {
    const s = String(sku ?? "");
    return s.length > 0 && s[0].toUpperCase() === "E";
  }

  function applyFactoryFilter(list) {
    if (factoryMode === "all") return list;
    if (factoryMode === "hideTW") return list.filter(r => !isTaiwanFactorySKU(r.sku));
    if (factoryMode === "onlyTW") return list.filter(r => isTaiwanFactorySKU(r.sku));
    return list;
  }

  function applyFilters(list) {
    let rows = applyFactoryFilter(list);
    if (itemFilterMode === "onlyNonTurkey") {
      return rows.filter(r => !nonTurkeySkuSet.has(normalizeSkuValue(r.sku)));
    }
    if (itemFilterMode === "onlyTurkey") {
      return rows.filter(r => nonTurkeySkuSet.has(normalizeSkuValue(r.sku)));
    }
    return rows;
  }

  function parseH10ToRows(raw) {
    const re = /([A-Z0-9]{10})([A-Z0-9][A-Z0-9-]{1,})/g;
    const found = [];
    let m;
    while ((m = re.exec(raw)) !== null) {
      const asin = m[1];
      const sku  = normalizeSku(m[2]);

      const lookahead = raw.slice(re.lastIndex, re.lastIndex + 400);
      const numMatch = lookahead.match(/(\d+(?:,\d{3})*(?:\.\d+)?)/);
      const speed = numMatch ? normalizeNumber(numMatch[1]) : null;

      found.push({ sku, asin, speed, order: null, us: null, avail: null, days: null });
    }
    return found;
  }

  function dedupeH10(list) {
    const seen = new Set();
    const out = [];
    for (const r of list) {
      const key = `${r.asin}__${r.sku}`;
      if (seen.has(key)) continue;
      seen.add(key);
      out.push(r);
    }
    return out;
  }

  function parseSkuNumberMap(raw) {
    const map = new Map();
    const lines = (raw || "").split(/\r?\n/);

    for (let line of lines) {
      line = line.trim();
      if (!line) continue;

      const lower = line.toLowerCase();
      if (lower.includes("productcode") || lower.includes("å“è™Ÿ") ||
          lower.includes("è£æ«ƒæ—¥") || lower.includes("é è¨ˆåˆ°æ¸¯æ—¥") ||
          lower.includes("ç¾åœ‹ç¸½æ•¸") || (lower.includes("sku") && lower.includes("ç¸½æ•¸"))) continue;

      let cols = line.split(/\t+/).map(s => s.trim()).filter(Boolean);
      if (cols.length < 2) cols = line.split(/\s+/).map(s => s.trim()).filter(Boolean);
      if (cols.length < 2) continue;

      const sku = normalizeSku(cols[0]);
      if (!/^[A-Z0-9][A-Z0-9-]{2,}$/i.test(sku)) continue;

      const tail = cols.slice(1).join(" ");
      const nums = tail.match(/-?\d+(?:,\d{3})*(?:\.\d+)?/g);
      if (!nums || nums.length === 0) continue;

      const val = normalizeNumber(nums[nums.length - 1]);
      if (val === null) continue;

      map.set(sku, (map.get(sku) ?? 0) + val);
    }
    return map;
  }

  function computeDerived(r) {
    const order = (r.order ?? 0);
    const us = (r.us ?? 0);
    r.avail = order + us;

    if (r.speed === null || r.speed <= 0) {
      r.days = null;
      return;
    }
    r.days = r.avail / r.speed;
  }

  function sortMain(rows) {
    if (sortMode === "days_asc") {
      rows.sort((a,b) => {
        const ad = (a.days === null ? Infinity : a.days);
        const bd = (b.days === null ? Infinity : b.days);
        if (ad !== bd) return ad - bd;
        const as = (a.speed === null ? -Infinity : a.speed);
        const bs = (b.speed === null ? -Infinity : b.speed);
        return bs - as;
      });
      return;
    }
    rows.sort((a,b) => {
      const as = (a.speed === null ? -Infinity : a.speed);
      const bs = (b.speed === null ? -Infinity : b.speed);
      return bs - as;
    });
  }

  function buildTables() {
    const rawH10 = h10El.value || "";
    const rawOrders = ordersEl.value || "";
    const rawUS = usEl.value || "";

    let h10Rows = parseH10ToRows(rawH10);
    if (chkDedupe.checked) h10Rows = dedupeH10(h10Rows);

    const orderMap = parseSkuNumberMap(rawOrders);
    const usMap = parseSkuNumberMap(rawUS);
    window.orderSpeedMap = new Map(
      h10Rows
        .filter(r => r.speed !== null && Number.isFinite(r.speed))
        .map(r => [r.sku, r.speed])
    );

    const h10SkuSet = new Set(h10Rows.map(r => r.sku));
    const h10RowMap = new Map(h10Rows.map(r => [r.sku, r]));

    for (const r of h10Rows) {
      const o = orderMap.get(r.sku);
      const u = usMap.get(r.sku);

      r.order = (o === undefined) ? (chkMissingOrderAsZero.checked ? 0 : null) : o;
      if (u === undefined) r.us = chkMissingUsAsBlank.checked ? null : 0;
      else r.us = u;

      computeDerived(r);
    }

    const newOrder = [];
    for (const [sku, qty] of orderMap.entries()) {
      if (!h10SkuSet.has(sku)) {
        const u = usMap.get(sku);
        newOrder.push({ sku, order: qty, us: (u === undefined ? null : u) });
      }
    }

    const newUS = [];
    for (const [sku, u] of usMap.entries()) {
      if (!h10SkuSet.has(sku) && !orderMap.has(sku)) {
        newUS.push({ sku, us: u });
      }
    }

    const hotRows = hotSkuList.map(rawSku => {
      const sku = normalizeSkuValue(rawSku);
      const h10Row = h10RowMap.get(sku);
      const orderVal = orderMap.get(sku);
      const usVal = usMap.get(sku);
      const row = {
        sku,
        asin: h10Row?.asin ?? null,
        speed: h10Row?.speed ?? null,
        order: (orderVal === undefined) ? null : orderVal,
        us: (usVal === undefined) ? null : usVal,
        avail: null,
        days: null
      };
      computeDerived(row);
      return row;
    });

    const threshold = Math.max(1, Number(daysThresholdEl.value || 180));
    const reorder = h10Rows
      .filter(r => r.days !== null && r.days <= threshold && r.speed !== null && r.speed > 0)
      .map(r => ({
        sku: r.sku,
        asin: r.asin,
        speed: r.speed,
        order: (r.order ?? 0),
        us: (r.us ?? 0),
        avail: (r.avail ?? 0),
        days: (r.days ?? 0)
      }));

    sortMain(h10Rows);
    reorder.sort((a,b) => a.days - b.days);
    newOrder.sort((a,b) => b.order - a.order);
    newUS.sort((a,b) => b.us - a.us);

    mainRowsAll = h10Rows;
    reorderRowsAll = reorder;
    hotRowsAll = hotRows;
    newOrderRowsAll = newOrder;
    newUSRowsAll = newUS;
    window.availMap = new Map(h10Rows.map(r => [r.sku, (r.avail ?? 0)]));

    renderAll();
    if (window.refreshGeneratorSpeedMetrics) {
      window.refreshGeneratorSpeedMetrics();
    }
  }

  function renderAll() {
    renderReorder();
    renderMain();
    renderHot();
    renderNewOrder();
    renderNewUS();
  }

  function renderReorder() {
    const rows = applyFilters(reorderRowsAll);
    countReorderEl.textContent = String(rows.length);

    if (rows.length === 0) { reorderWrap.innerHTML = ""; return; }

    const body = rows.map((r, idx) => `
      <tr>
        <td>${idx + 1}</td>
        ${renderSkuCell(r.sku)}
        <td class="ok">${escapeHtml(String(r.speed))}</td>
        <td class="ok">${escapeHtml(String(r.order))}</td>
        <td class="ok">${escapeHtml(String(r.us))}</td>
        <td class="warn">${escapeHtml(fmtDays(r.days))}</td>
      </tr>
    `).join("");

    reorderWrap.innerHTML = `
      <table>
        <thead>
          <tr>
            <th>#</th><th>SKU</th><th>é€Ÿåº¦</th><th>è¨‚å–®</th><th>ç¾åœ‹ç¸½æ•¸</th><th>å¯éŠ·å”®å¤©æ•¸</th>
          </tr>
        </thead>
        <tbody>${body}</tbody>
      </table>
    `;
  }

  function calculateReorderQuantity(row, thresholdDays) {
    const speed = Number(row.speed || 0);
    const currentDays = Number(row.days || 0);
    if (!speed || !Number.isFinite(speed)) return 0;
    const gapDays = Math.max(0, thresholdDays - currentDays);
    return Math.ceil(gapDays * speed);
  }

  function addReorderRowsToGenerator() {
    const rows = applyFilters(reorderRowsAll);
    if (rows.length === 0) {
      showTip('ç›®å‰æ²’æœ‰å¯åŠ å…¥çš„ä¸‹å–®å“é …', 'error');
      return;
    }
    const threshold = Math.max(1, Number(daysThresholdEl.value || 180));
    const missing = [];
    const skipped = [];
    rows.forEach(row => {
      if (isDiscontinuedSku(row.sku)) {
        skipped.push(row.sku);
        return;
      }
      const prod = getProductSpecByCode(row.sku);
      if (!prod) {
        missing.push(row.sku);
        return;
      }
      const qty = calculateReorderQuantity(row, threshold);
      addProduct(prod, qty);
    });
    if (missing.length) {
      showTip(`ä»¥ä¸‹ SKU æ‰¾ä¸åˆ°å“é …è³‡æ–™ï¼š${missing.join(', ')}`, 'error');
    }
    if (skipped.length) {
      showTip(`åœç”¢å“é …æœªåŠ å…¥è¨‚å–®ç”¢ç”Ÿå™¨ï¼š${skipped.join(', ')}`, 'error');
    }
  }

  function addHotRowsToGenerator() {
    const rows = applyFilters(hotRowsAll);
    if (rows.length === 0) {
      showTip('ç›®å‰æ²’æœ‰å¯åŠ å…¥çš„ç†±éŠ·å“', 'error');
      return;
    }
    const missing = [];
    const skipped = [];
    rows.forEach(row => {
      if (isDiscontinuedSku(row.sku)) {
        skipped.push(row.sku);
        return;
      }
      const prod = getProductSpecByCode(row.sku);
      if (!prod) {
        missing.push(row.sku);
        return;
      }
      const qty = (row.order !== null && Number.isFinite(row.order)) ? row.order : null;
      addProduct(prod, qty);
    });
    if (missing.length) {
      showTip(`ä»¥ä¸‹ SKU æ‰¾ä¸åˆ°å“é …è³‡æ–™ï¼š${missing.join(', ')}`, 'error');
    }
    if (skipped.length) {
      showTip(`åœç”¢å“é …æœªåŠ å…¥è¨‚å–®ç”¢ç”Ÿå™¨ï¼š${skipped.join(', ')}`, 'error');
    }
  }

  function renderMain() {
    const rows = applyFilters(mainRowsAll);
    if (rows.length === 0) { mainWrap.innerHTML = ""; return; }

    const body = rows.map((r, idx) => {
      const speedCell = (r.speed === null) ? `<td class="bad">(æœªæŠ“åˆ°)</td>` : `<td class="ok">${escapeHtml(String(r.speed))}</td>`;
      const orderCell = (r.order === null) ? `<td class="bad">(æœªå°æ‡‰)</td>` : `<td class="ok">${escapeHtml(String(r.order))}</td>`;
      const usCell = (r.us === null) ? `<td class="bad">(æœªå°æ‡‰)</td>` : `<td class="ok">${escapeHtml(String(r.us))}</td>`;
      const daysCell = (r.days === null) ? `<td class="bad">(ä¸å¯ç®—)</td>` : `<td class="ok">${escapeHtml(fmtDays(r.days))}</td>`;

      return `
        <tr>
          <td>${idx + 1}</td>
          ${renderSkuCell(r.sku)}
          ${speedCell}
          ${orderCell}
          ${usCell}
          ${daysCell}
        </tr>
      `;
    }).join("");

    mainWrap.innerHTML = `
      <table>
        <thead>
          <tr>
            <th>#</th><th>SKU</th><th>é€Ÿåº¦</th><th>è¨‚å–®</th><th>ç¾åœ‹ç¸½æ•¸</th><th>å¯éŠ·å”®å¤©æ•¸</th>
          </tr>
        </thead>
        <tbody>${body}</tbody>
      </table>
    `;
  }

  function renderHot() {
    const rows = applyFilters(hotRowsAll);
    countHotEl.textContent = String(rows.length);
    if (rows.length === 0) { hotWrap.innerHTML = ""; return; }

    const body = rows.map((r, idx) => {
      const speedCell = (r.speed === null) ? `<td class="bad">(æœªæŠ“åˆ°)</td>` : `<td class="ok">${escapeHtml(String(r.speed))}</td>`;
      const orderCell = (r.order === null) ? `<td class="bad">(æœªå°æ‡‰)</td>` : `<td class="ok">${escapeHtml(String(r.order))}</td>`;
      const usCell = (r.us === null) ? `<td class="bad">(æœªå°æ‡‰)</td>` : `<td class="ok">${escapeHtml(String(r.us))}</td>`;
      const daysCell = (r.days === null) ? `<td class="bad">(ä¸å¯ç®—)</td>` : `<td class="ok">${escapeHtml(fmtDays(r.days))}</td>`;
      return `
        <tr>
          <td>${idx + 1}</td>
          ${renderSkuCell(r.sku)}
          ${speedCell}
          ${orderCell}
          ${usCell}
          ${daysCell}
        </tr>
      `;
    }).join("");

    hotWrap.innerHTML = `
      <table>
        <thead>
          <tr>
            <th>#</th><th>SKU</th><th>é€Ÿåº¦</th><th>è¨‚å–®</th><th>ç¾åœ‹ç¸½æ•¸</th><th>å¯éŠ·å”®å¤©æ•¸</th>
          </tr>
        </thead>
        <tbody>${body}</tbody>
      </table>
    `;
  }

  function renderNewOrder() {
    const rows = applyFilters(newOrderRowsAll);
    countNewOrderEl.textContent = String(rows.length);
    if (rows.length === 0) { newOrderWrap.innerHTML = ""; return; }

    const body = rows.map((r, idx) => {
      const usCell = (r.us === null) ? `<td class="bad">(æœªæä¾›)</td>` : `<td class="ok">${escapeHtml(String(r.us))}</td>`;
      return `
        <tr>
          <td>${idx + 1}</td>
          ${renderSkuCell(r.sku)}
          <td class="ok">${escapeHtml(String(r.order))}</td>
          ${usCell}
        </tr>
      `;
    }).join("");

    newOrderWrap.innerHTML = `
      <table>
        <thead>
          <tr><th>#</th><th>SKU</th><th>è¨‚å–®</th><th>ç¾åœ‹ç¸½æ•¸</th></tr>
        </thead>
        <tbody>${body}</tbody>
      </table>
    `;
  }

  function renderNewUS() {
    const rows = applyFilters(newUSRowsAll);
    // countNewUS åªæœ‰åœ¨å±•é–‹æ™‚æ‰é¡¯ç¤ºä¹Ÿå¯ä»¥ï¼Œä½†é€™è£¡ä¿ç•™æ›´æ–°
    countNewUSEl.textContent = String(rows.length);
    if (rows.length === 0) { newUSWrap.innerHTML = ""; return; }

    const body = rows.map((r, idx) => `
      <tr>
        <td>${idx + 1}</td>
        ${renderSkuCell(r.sku)}
        <td class="ok">${escapeHtml(String(r.us))}</td>
      </tr>
    `).join("");

    newUSWrap.innerHTML = `
      <table>
        <thead>
          <tr><th>#</th><th>SKU</th><th>ç¾åœ‹ç¸½æ•¸</th></tr>
        </thead>
        <tbody>${body}</tbody>
      </table>
    `;
  }

  // ---- Export ----
  function download(filename, content, mime) {
    const blob = new Blob([content], { type: mime });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = filename;
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  }
  function downloadRowsAsExcel(headers, rows, filename, sheetName = "ä¸»è¡¨") {
    const wb = XLSX.utils.book_new();
    const sheetData = [headers, ...rows];
    const ws = XLSX.utils.aoa_to_sheet(sheetData);
    XLSX.utils.book_append_sheet(wb, ws, sheetName);
    XLSX.writeFile(wb, filename);
  }
  function csvFromRows(headers, rows) {
    const q = (v) => `"${String(v ?? "").replace(/"/g, '""')}"`;
    const head = headers.map(q).join(",");
    const body = rows.map(r => r.map(q).join(",")).join("\n");
    return head + "\n" + body;
  }
  function getDateStamp() {
    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, "0");
    const dd = String(now.getDate()).padStart(2, "0");
    return `${yyyy}${mm}${dd}`;
  }

  function exportMainRowsFiltered() {
    const rows = applyFilters(mainRowsAll);
    const headers = ["SKU","ASIN","é€Ÿåº¦","è¨‚å–®","ç¾åœ‹ç¸½æ•¸","å¯å”®ç¸½é‡(ç¾åœ‹+è¨‚å–®)","å¯éŠ·å”®å¤©æ•¸"];
    const body = rows.map(r => [
      r.sku, r.asin,
      (r.speed ?? ""),
      (r.order ?? ""),
      (r.us ?? ""),
      (r.avail ?? ""),
      (r.days === null ? "" : fmtDays(r.days))
    ]);
    return { headers, body };
  }
  function exportReorderRowsFiltered() {
    const rows = applyFilters(reorderRowsAll);
    const headers = ["SKU","ASIN","é€Ÿåº¦","è¨‚å–®","ç¾åœ‹ç¸½æ•¸","å¯å”®ç¸½é‡(ç¾åœ‹+è¨‚å–®)","å¯éŠ·å”®å¤©æ•¸"];
    const body = rows.map(r => [
      r.sku, r.asin, String(r.speed), String(r.order), String(r.us), String(r.avail), fmtDays(r.days)
    ]);
    return { headers, body };
  }
  function exportNewOrderRowsFiltered() {
    const rows = applyFilters(newOrderRowsAll);
    const headers = ["SKU","è¨‚å–®","ç¾åœ‹ç¸½æ•¸"];
    const body = rows.map(r => [r.sku, String(r.order), (r.us ?? "").toString()]);
    return { headers, body };
  }
  function exportNewUSRowsFiltered() {
    const rows = applyFilters(newUSRowsAll);
    const headers = ["SKU","ç¾åœ‹ç¸½æ•¸"];
    const body = rows.map(r => [r.sku, String(r.us)]);
    return { headers, body };
  }

  // ---- UI wiring ----
  document.getElementById("btnBuild").addEventListener("click", buildTables);

  daysThresholdEl.addEventListener("change", () => buildTables());

  factoryFilterEl.addEventListener("change", (event) => {
    factoryMode = event.target.value;
    renderAll();
  });

  itemFilterEl.addEventListener("change", (event) => {
    itemFilterMode = event.target.value;
    renderAll();
  });

  function updateSortButtons() {
    btnSortSpeed.classList.toggle("active", sortMode === "normal");
    btnSortDays.classList.toggle("active", sortMode === "days_asc");
  }

  btnSortSpeed.addEventListener("click", () => {
    sortMode = "normal";
    updateSortButtons();
    buildTables();
  });

  btnSortDays.addEventListener("click", () => {
    sortMode = "days_asc";
    updateSortButtons();
    buildTables();
  });

  // Export buttons
  document.getElementById("btnDownloadMainCSV").addEventListener("click", () => {
    const ex = exportMainRowsFiltered();
    const dateStamp = getDateStamp();
    const filename = `${dateStamp}_Supply.xlsx`;
    downloadRowsAsExcel(ex.headers, ex.body, filename, "Supply");
  });

  document.getElementById("btnDownloadReorderCSV").addEventListener("click", () => {
    const ex = exportReorderRowsFiltered();
    download("ä¸‹å–®æ¸…å–®.csv", "\uFEFF" + csvFromRows(ex.headers, ex.body), "text/csv;charset=utf-8");
  });

  document.getElementById("btnAddReorderToGenerator").addEventListener("click", () => {
    addReorderRowsToGenerator();
  });

  document.getElementById("btnAddHotToGenerator").addEventListener("click", () => {
    addHotRowsToGenerator();
  });

  document.getElementById("btnDownloadNewOrderCSV").addEventListener("click", () => {
    const ex = exportNewOrderRowsFiltered();
    download("æ–°å“_è¨‚å–®.csv", "\uFEFF" + csvFromRows(ex.headers, ex.body), "text/csv;charset=utf-8");
  });

  document.getElementById("btnDownloadNewUSCSV").addEventListener("click", () => {
    const ex = exportNewUSRowsFiltered();
    download("æ–°å“_ç¾åœ‹ç¸½æ•¸.csv", "\uFEFF" + csvFromRows(ex.headers, ex.body), "text/csv;charset=utf-8");
  });

  // â‘¦ é è¨­æ”¶æŠ˜
  newUSDetails.open = false;
  updateSortButtons();
})();
</script>
<script>
  // å•†å“è³‡æ–™ç¯„ä¾‹
const allProducts = [
  { productCode: "1GBRD019A0", productName: "Gootoe - Buffalo Bites Bone Shaped - 1.5lb (Pack of 3)", boxSize: "50*40*30", perCarton: 9, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GBRD029A0", productName: "Gootoe - Buffalo Bites Stick (Large) - 1.5lb (Pack of 3)", boxSize: "50*40*30", perCarton: 8, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD010A0", productName: "A freschi Air-Dried Dog Food-Turkey Recipe , 0.9oz", boxSize: "50*40*30", perCarton: 250, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD170A0", productName: "A freschi Air-Dried Dog Food-Turkey & Salmon Recipe , 0.9oz", boxSize: "50*40*30", perCarton: 250, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD073A0", productName: "A Freschi  Air-dried Dog Food-Chicken & Salmon Recipe , 1lb", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD075A0", productName: "A Freschi Air-dried Dog Food-Chicken & Salmon Recipe , 2.2lb", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD070A0", productName: "A Freschi  Air-dried Dog Food-Chicken & Salmon Recipe , 0.9oz", boxSize: "50*40*30", perCarton: 250, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD063A0", productName: "A Freschi  Air-dried Dog Food-Chicken Recipe , 1lb", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD065A0", productName: "A Freschi  Air-dried Dog Food-Chicken Recipe , 2.2lb", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD060A0", productName: "A Freschi  Air-dried Dog Food-Chicken Recipe , 0.9oz", boxSize: "50*40*30", perCarton: 250, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD473A0", productName: "A Freschi srl Air-dried Dog Food - Buffalo & Salmon Recipe , 1lb", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD475A0", productName: "A Freschi srl Air-dried Dog Food - Buffalo & Salmon Recipe , 2.2lb", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD470A0", productName: "A Freschi srl Air-dried Dog Food - Buffalo & Salmon Recipe , 0.9oz", boxSize: "50*40*30", perCarton: 250, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD463A0", productName: "A Freschi srl  Air-dried Dog Food - Buffalo & Chicken Recipe , 1lb", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD465A0", productName: "A Freschi srl  Air-dried Dog Food - Buffalo & Chicken Recipe , 2.2lb", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1AWDD460A0", productName: "A Freschi srl  Air-dried Dog Food - Buffalo & Chicken Recipe , 0.9oz", boxSize: "50*40*30", perCarton: 250, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1VADD063A0", productName: "VITADAY - Air-Dried Dog Food - Chicken Recipe - Stomach Support Formula - 454g", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1VADD073A0", productName: "VITADAY - Air-Dried Dog Food - Chicken & Mackerels Recipe - Joint Support Formula - 454g", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GCRD017A0", productName: "Gootoe - Chicken Fillet Jerky - 1lb (Pack of 3)", boxSize: "50*40*30", perCarton: 9, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GCRD027A0", productName: "Gootoe - Chicken Breast Jerky - 1lb (Pack of 3)", boxSize: "50*40*30", perCarton: 11, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GCRD037A0", productName: "Gootoe - Chicken Chips - 1lb (Pack of 3)", boxSize: "50*40*30", perCarton: 9, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GQRD017A0", productName: "Gootoe - Soft Chicken Breast Strips - 1lb (Pack of 3)", boxSize: "50*40*30", perCarton: 10, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GQRD027A0", productName: "Gootoe - Soft Chicken Sticks - 1lb (Pack of 3)", boxSize: "50*40*30", perCarton: 11, perPack: 3, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GSDD011A0", productName: "GooToE Chicken Breast Wrapped Salmon Sticks , 6oz", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GSDD015A0", productName: "GooToE Chicken Breast Wrapped Salmon Sticks , 1.5lb", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GCRD005A0", productName: "GooToE Chicken Breast Wrapped Sticks , 6oz", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1GCRD004A0", productName: "GooToE Chicken Breast Wrapped Sticks , 1.5lb", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1ABRD001A0", productName: "A Freschi  Buffalo Jerky Dog Treats , 4oz", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1ABRD002A0", productName: "A Freschi  Buffalo Jerky Dog Treats , 12oz", boxSize: "50*40*30", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1ABRD003A0", productName: "A Freschi  Buffalo Strips , 4oz", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1ABRD004A0", productName: "A Freschi  Buffalo Strips , 12oz", boxSize: "50*40*30", perCarton: 48, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "1MHTD011A0", productName: "Healthy Moment - Functional Dog Treat - Skin & Coat Care - 150g", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD021A0", productName: "Healthy Moment - Functional Dog Treat- Gastrointestinal Care - 150g", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD031A0", productName: "Healthy Moment - Functional Dog Treat-Joint Care - 150g", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD041A0", productName: "Healthy Moment - Functional Dog Treat - Eyes Care - 150g", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD051A0", productName: "Healthy Moment - Functional Dog Treat-Heart Health Care - 150g", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD017A0", productName: "Healthy Moment - Functional Dog Treat - Skin & Coat Care - Box", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD027A0", productName: "Healthy Moment - Functional Dog Treat- Gastrointestinal Care - Box", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD037A0", productName: "Healthy Moment - Functional Dog Treat - Joint Care - Box", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD047A0", productName: "Healthy Moment - Functional Dog Treat - Eyes Care - Box", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "1MHTD057A0", productName: "Healthy Moment - Functional Dog Treat - Heart Health Care - Box", boxSize: "50*40*30", perCarton: 8, perPack: null, perBox: 6, perPallet: 42, country: "VN" },
  { productCode: "AFA11AM", productName: "AFreschi-Classic Turkey Tendon Thin Stick (100g /pk)ï¼›AFK package (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA12AM", productName: "AFreschi-Classic Turkey Tendon Braided Stick(100g /pk)ï¼›AFK package (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA13AM", productName: "AFreschi-Classic Turkey Tendon Slice (100g /pk)ï¼›AFK package (100 units /CTN)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA14AM", productName: "AFreschi-Classic Turkey Tendon Flake(100g /pk)ï¼›AFK package (80 units /CTN)", boxSize: "50*40*30", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA21AM", productName: "AFreschi-Soft Turkey Tendon & Pumpkin strip (100g /pk)ï¼›AFK package (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA22AM", productName: "AFreschi-Soft Turkey Tendon Strip (100g /pk)ï¼›AFK package (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA31AM", productName: "AFreschi-Wrapped Turkey Tendon with Chicken Stick (100g /pk)ï¼›AFK package (100 units /CTN)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA32AM", productName: "AFreschi-Wrapped Turkey Tendon with Brown Rice Stick(100g /pk)ï¼›AFK package (100 units /CTN)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA25AM", productName: "AFreschi-Classic Turkey Tendon Coil-L(85g /pk)ï¼›AFK package (70 units /CTN)", boxSize: "50*40*30", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA135AM", productName: "AFreschi-Classic Turkey Tendon Coil-S(85g /pk)ï¼›AFK package (70 units /CTN)", boxSize: "50*40*30", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTS01", productName: "Gootoe - Turkey Tendon Strip (85g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTR01", productName: "Gootoe - Turkey Tendon Ring_S(72g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTB01", productName: "Gootoe - Turkey Tendon Bone_S(72g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTP01", productName: "Gootoe - Turkey Tendon Rope_S(72g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTZ01", productName: "Gootoe - Turkey Tendon Pretzel_S(72g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTA01", productName: "Gootoe - Turkey Tendon Braid_S(90g x 120)", boxSize: "58.5*34.5*35", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTC01", productName: "Gootoe - Sliced Turkey Tendon (85g x 120)", boxSize: "58.5*34.5*35", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTR03", productName: "Gootoe - Turkey Tendon Ring_M(90g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTB03", productName: "Gootoe - Turkey Tendon Bone_M(90g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTP03", productName: "Gootoe - Turkey Tendon Rope_M(90g x 100)", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTS03", productName: "Gootoe - Turkey Tendon Stick_M(90g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTZ03", productName: "Gootoe - Turkey Tendon Pretzel_M(90g x 120)", boxSize: "58.5*34.5*35", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTB05", productName: "Gootoe - Turkey Tendon Bone_L(100g x 100)", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTP05", productName: "Gootoe - Turkey Tendon Rope_L(100g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTB07", productName: "Gootoe - Turkey tendon lolipop 15g x 5pcs (75g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSF01", productName: "Soft Turkey Tendon Strip with Pumpkin (85g x 150)", boxSize: "50*40*30", perCarton: 150, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSF02", productName: "Soft Turkey Tendon Strip (85g x 150)", boxSize: "50*40*30", perCarton: 150, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTSL01", productName: "Gootoe - Turkey Tendon Strip (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTRL01", productName: "Gootoe - Turkey Tendon Ring_S (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTPL01", productName: "Gootoe - Turkey Tendon Rope_S (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTBL01", productName: "Gootoe - Turkey Tendon Bone_S (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTAL01", productName: "Gootoe - Turkey Tendon Braid_S (454g x 38)", boxSize: "50*40*40", perCarton: 38, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTCL01", productName: "Gootoe - Turkey Tendon Sliced (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTRL03", productName: "Gootoe - Turkey Tendon Ring_M (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTPL03", productName: "Gootoe - Turkey Tendon Rope_M (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTBL03", productName: "Gootoe - Turkey Tendon Bone_M (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTZL03", productName: "Gootoe - Turkey Tendon Pretzel_M (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTPL05", productName: "Gootoe - Turkey Tendon Rope_L (454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTBL05", productName: "Gootoe - Turkey Tendon Bone_L(454g x 30)", boxSize: "50*40*40", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GSFL01", productName: "Soft Turkey Tendon Strip with Pumpkin (454g x 38)", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSFL02", productName: "Soft Turkey Tendon Strip (454g x 38)", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATS01", productName: "Natural Turkey Tendon Strip (100g)", boxSize: "50*40*30", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATB01", productName: "Afreschi srl - Natural Turkey Tendon Bone_S(72g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATR01AM", productName: "Afreschi srl - Natural Turkey Tendon Ring_S(72g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATP01", productName: "Afreschi srl - Natural Turkey Tendon Rope_S(72g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATZ01", productName: "Afreschi srl - Natural Turkey Tendon Pretzel_S(72g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATA01", productName: "Afreschi srl - Natural Turkey Tendon Braid(90g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATB03", productName: "Afreschi srl - Natural Turkey Tendon Bone_M(90g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATR03", productName: "Afreschi srl - Natural Turkey Tendon Ring_M(90g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATP03", productName: "Afreschi srl - Natural Turkey Tendon Rope_M(90g)", boxSize: "50*40*30", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATZ03", productName: "Afreschi srl - Natural Turkey Tendon Pretzel_M(90g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATB05", productName: "Afreschi srl - Natural Turkey Tendon Bone_L(100g)", boxSize: "50*40*30", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATP05", productName: "Afreschi srl- Natural Turkey Tendon Rope_L(100g)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATAL01", productName: "Afreschi Natural Turkey Tendon Braid 8oz (GTA01:227g x 42)", boxSize: "50*40*30", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB01AM", productName: "Natural Turkey Tendon Bone_S (40 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "TRP01AM", productName: "Natural Turkey Tendon Rope_S (40 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "TTR01AM", productName: "Natural Turkey Tendon Ring_S (40 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "TPZ01AM", productName: "Natural Turkey Tendon Pretzel_S (40 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "KTB03AM", productName: "Natural Turkey Tendon Bone_M (20 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TRP03AM", productName: "Natural Turkey Tendon Rope_M (20 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TTR03AM", productName: "Natural Turkey Tendon Ring_M (20 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TPZ03AM", productName: "Natural Turkey Tendon Pretzel-M (20 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TRP05AM", productName: "Natural Turkey Tendon Rope_L (10 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "KTB05AM", productName: "Natural Turkey Tendon Bone_L (10 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "TTR05AM", productName: "Natural Turkey Tendon Ring_L (10 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "TPZ05AM", productName: "Natural Turkey Tendon Pretzel_L (10 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "TTS05AM", productName: "Natural Turkey Tendon Strip (10 units /box ; 8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "KTB06AM", productName: "Natural Turkey Tendon Lollipop (40 unitsï¼›8 boxes /CTN)", boxSize: "58.5*34.5*35", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "KTB01AM-4", productName: "Natural Turkey Tendon Bone_S (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTR01AM-4", productName: "Natural Turkey Tendon Ring_S (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRP01AM-4", productName: "Natural Turkey Tendon Rope_S (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZ01AM-4", productName: "Natural Turkey Tendon Pretzel_S (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB03AM-2", productName: "Natural Turkey Tendon Bone_M (80 units /CTN)", boxSize: "50*40*30", perCarton: 80, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRP03AM-2", productName: "Natural Turkey Tendon Rope_M (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTR03AM-2", productName: "Natural Turkey Tendon Ring_M (80 units /CTN)", boxSize: "50*40*30", perCarton: 80, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZ03AM-2", productName: "Natural Turkey Tendon Pretzel_M (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB05AM-1", productName: "Natural Turkey Tendon Bone_L (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRP05AM-1", productName: "Natural Turkey Tendon Rope_L (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTR05AM-1", productName: "Natural Turkey Tendon Ring_L (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZ05AM-1", productName: "Natural Turkey Tendon Pretzel_L (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTS05AM-1", productName: "Natural Turkey Tendon Strip (100 units /CTN)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB06AM-4", productName: "Natural Turkey Tendon Lollipop (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTBL01", productName: "Afreschi Natural Turkey Tendon Bone 8oz_S-15g (227g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTRL01", productName: "Afreschi Natural Turkey Tendon Ring 8oz_S-12g (227g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZL01", productName: "Afreschi Natural Turkey Tendon Pretzel 8oz_S-12g (227g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRPL01", productName: "Afreschi Natural Turkey Tendon Rope 8oz_S-12g (227g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTBL03", productName: "Afreschi Natural Turkey Tendon Bone 10oz_M-36g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTRL03", productName: "Afreschi Natural Turkey Tendon Ring 10oz_M-36g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZL03", productName: "Afreschi Natural Turkey Tendon Pretzel 10oz_M-36g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRPL03", productName: "Afreschi Natural Turkey Tendon Rope 10oz_M-36g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTRL05", productName: "Afreschi Natural Turkey Tendon Ring 10oz_L-72g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRPL05", productName: "Afreschi Natural Turkey Tendon Rope 10oz_L-72g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZL05", productName: "Afreschi Natural Turkey Tendon Pretzel 10oz_L-72g (285g x 36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTBL05", productName: "Afreschi Natural Turkey Tendon Bone 10oz_L-72g (285g x 30)", boxSize: "50*40*30", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTSL05", productName: "Afreschi Natural Turkey Tendon Strip 10oz (285g x 30)", boxSize: "50*40*30", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFML01", productName: "AFreschi Turkey Tendon Variety Pack 8oz_Small (227gx36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFML03", productName: "AFreschi Turkey Tendon Variety Pack 10oz_Medium (285gx36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFML05", productName: "AFreschi Turkey Tendon Variety Pack 10oz_Large (285gx36)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASF01", productName: "A Freschi Srl â€“ Natural Turkey Treats Soft Sticks (170g x 100)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ABM01", productName: "A Freschi Srl â€“ Natural Turkey Treats Sticks_Î²-Carotene added (170g x 110)", boxSize: "50*40*30", perCarton: 110, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATN01", productName: "A Freschi Srl â€“ Natural Turkey Treats Star Bites (170g x 80)", boxSize: "50*40*30", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASA01", productName: "A Freschi Srl â€“ Natural Turkey Treats Mini Bars (170g x 80)", boxSize: "50*40*30", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ADT03", productName: "Natural Dental Treats-Real Turkey Meat (1kg x20 units /CTN)", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATJ01", productName: "Afreschi - Natural Turkey Jerky 4oz (113gx110)", boxSize: "50*40*30", perCarton: 110, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTT01", productName: "Gootoe Turkey Tendon Twists 5oz_Small (142g*120)", boxSize: "58.5*34.5*35", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTT03", productName: "Gootoe Turkey Tendon Twists 5oz_Medium (142g*120)", boxSize: "58.5*34.5*35", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "ASFL01", productName: "A Freschi Srl â€“ Natural Turkey Treats Soft Sticks (454g)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ABML01", productName: "A Freschi Srl â€“ Natural Turkey Treats Sticks_Î²-Carotene added (454g)", boxSize: "50*40*30", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATNL01", productName: "A Freschi Srl â€“ Natural Turkey Treats Star Bites (454g)", boxSize: "50*40*30", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASAL01", productName: "A Freschi Srl â€“ Natural Turkey Treats Mini Bars (454g)", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATJL01", productName: "A Freschi Srl â€“ Natural Turkey Jerky (12oz-340g)", boxSize: "50*40*30", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCBL01", productName: "Gootoe - Chicken Fillet Jerky 454gx30", boxSize: "50*40*30", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCBL02", productName: "Gootoe - Chicken Jerky Breast 454gx36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCBL03", productName: "Gootoe - Chicken Chips 454gx28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL01", productName: "Gootoe - Soft Chicken Breast Strips 454gx36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL02", productName: "Gootoe - Soft Chicken Sticks 454gx36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL03", productName: "Gootoe - Soft Chicken Dental Chews with Chlorophyll, 1.5lb (681gx28)", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL04", productName: "Gootoe - Soft Chicken Knots 454gx30", boxSize: "50*40*30", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL05", productName: "Gootoe - Soft Chicken Jerky Cuts 454gx36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL01", productName: "Gootoe - Chicken Sticks 1.5lb-681gx28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL02", productName: "Gootoe - Chicken Sticks With Chicken Liver 1.5lb-681gx28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL03", productName: "Gootoe - Chicken Sticks With Sweet Potato 1.5lb-681gx28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL04", productName: "Gootoe - Chicken Mini Sticks 1.5lb-681gx22", boxSize: "50*40*30", perCarton: 22, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL05", productName: "Gootoe - Chicken Roll 12oz-340gx24", boxSize: "50*40*30", perCarton: 24, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL06", productName: "Gootoe - Chicken Dipped Sticks 1.5lb-681gx28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBS01", productName: "Gootoe - Buffalo Bites Stick _S (70units /CTN)", boxSize: "50*40*30", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBS03", productName: "Gootoe - Buffalo Bites Stick _L (70 units /CTN)", boxSize: "50*40*30", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBB01", productName: "Gootoe - Buffalo Bites Bone Shaped (60 units /CTN)", boxSize: "50*40*30", perCarton: 60, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBSL01", productName: "Gootoe - Buffalo Bites Stick (small) (S) 1.5lb-681g", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBSL03", productName: "Gootoe - Buffalo Bites Stick (Large) (L) 1.5lb-681g", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBBL01", productName: "Gootoe - Buffalo Bites Bone Shaped 1.5lb-681g", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD010", productName: "AFreschi Air-Dried Dog Food - USA Turkey Recipe(W-shaped)-454g", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD011", productName: "AFreschi Air-Dried Dog Food - USA Turkey Recipe(W-shaped)-1kg", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD070", productName: "AFreschi Air - Dried Dog Food - Turkey & Salmon Recipe(W-shaped)-454g", boxSize: "50*40*30", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD071", productName: "AFreschi Air - Dried Dog Food - Turkey & Salmon Recipe(W-shaped)-1kg", boxSize: "50*40*30", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTS01-1", productName: "Turkey Tendon Strip (100 units /CTN)", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTB01-4", productName: "Turkey Tendon Bone_S (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTR01-4", productName: "Turkey Tendon Ring_S (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTB05-1", productName: "Turkey Tendon Bone_L (120 units /CTN)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTB06-4", productName: "Turkey Tendon Lollipop (90 units /CTN)", boxSize: "50*40*30", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "HDR01AM", productName: "Herz_ Turkey Tendon_Duo-Protein_Ring (S) (85g)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "HDP01AM", productName: "Herz_ Turkey Tendon_Duo-Protein_Rope(S)(85g)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "HDS03AM", productName: "Herz_ Turkey Tendon_Duo-Protein_Strip(85g)", boxSize: "50*40*30", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACBL01", productName: "AFreschi - Natural Chicken Fillet Jerky 454g*30", boxSize: "50*40*30", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACBL02", productName: "AFreschi - Natural Chicken Breast Jerky 454g*36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACBL03", productName: "AFreschi - Natural Chicken Chips 454g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL01", productName: "AFreschi - Natural Soft Chicken Breast Strips 454g*36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL02", productName: "AFreschi - Natural Soft Chicken Sticks 454g*36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL03", productName: "AFreschi - Natural Soft Chicken Dental Chews with Chlorophyll 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL04", productName: "AFreschi - Natural Soft Chicken Knots 454g*30", boxSize: "50*40*30", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL05", productName: "AFreschi - Natural Soft Chicken Jerky Cuts 454g*36", boxSize: "50*40*30", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL01", productName: "AFreschi - Natural Chicken Sticks 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL02", productName: "AFreschi - Natural Chicken Sticks with Chicken Liver 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL03", productName: "AFreschi - Natural Chicken Sticks with Sweet Potato 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL04", productName: "AFreschi - Natural Chicken Sticks (Mini) 681g*22", boxSize: "50*40*30", perCarton: 22, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL05", productName: "AFreschi - Natural Chicken Roll 340g*24", boxSize: "50*40*30", perCarton: 24, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL06", productName: "AFreschi - Natural Chicken Dipped Sticks 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL07", productName: "AFreschi - Natural Chicken Dipped Rice Sticks 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL08", productName: "AFreschi - Natural Chicken Sliced 681g*24", boxSize: "50*40*30", perCarton: 24, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL09", productName: "AFreschi - Natural Chicken Dipped Rice Bone 454g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL10", productName: "AFreschi - Natural Chicken Sticks with Pumpkin 681g*28", boxSize: "50*40*30", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACA01", productName: "Afreschi - Natural Cat Treats (Chicken & Mackerel) -6oz-170gx100", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACA02", productName: "Afreschi - Natural Cat Treats (Buffalo& Chicken & Fish) -6oz-170gx100", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACA03", productName: "Afreschi - Natural Cat Treats (Turkey & Chicken & Mackerel) -6oz-170gx100", boxSize: "50*40*30", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBS01", productName: "Vitaday - Buffalo Treats Stick (Small) 227g*70", boxSize: "50*40*30", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBS03", productName: "Vitaday - Buffalo Treats Stick (Medium) 227g*70", boxSize: "50*40*30", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBB01", productName: "Vitaday - Buffalo Treats Bone Shaped 227g*60", boxSize: "50*40*30", perCarton: 60, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBW01", productName: "Vitaday - Buffalo Treats W Shaped 227g*80", boxSize: "50*40*30", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "EZD011AM", productName: "Herz Grain-Free U.S.A. Turkey Breast Recipe (908g/Pk)", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD021AM", productName: "Herz Grain-Free Australian Lamb Recipe (908g/Pk)", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD041AM", productName: "Herz Grain-Free New Zealand Grass-Fed Beef Recipe (908g/Pk)", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD051AM", productName: "Herz Grain-Free New Zealand Venison Recipe (908g/Pk)", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD061AM", productName: "Herz Grain-Free U.S.A. Chicken Recipe (908g/Pk)", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD010AM", productName: "Herz Grain-Free U.S.A. Turkey Breast Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD020AM", productName: "Herz Grain-Free Australian Lamb Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD040AM", productName: "Herz Grain-Free New Zealand Grass-Fed Beef Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD050AM", productName: "Herz Grain-Free New Zealand Venison Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD060AM", productName: "Herz Grain-Free U.S.A. Chicken Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD010AM-3", productName: "Herz Grain-Free U.S.A. Turkey Breast Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD020AM-3", productName: "Herz Grain-Free Australian Lamb Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD040AM-3", productName: "Herz Grain-Free New Zealand Grass-Fed Beef Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD050AM-3", productName: "Herz Grain-Free New Zealand Venison Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD060AM-3", productName: "Herz Grain-Free U.S.A. Chicken Recipe (100g/Pk)", boxSize: "48*38*28", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EPD011J", productName: "Herz Premium Canine Cuisine â€“ Turkey with Duck Liver Recipe, 1kg", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD021J", productName: "Premium Canine Cuisine-Lamb with Duck Liver Ricipe-1kg", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD041J", productName: "Premium Canine Cuisine-Beef with Duck Liver Ricipe-1kg", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD061J", productName: "Premium Canine Cuisine-Chicken with Duck Liver Ricipe-1kg", boxSize: "48*38*28", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD010J", productName: "Premium Canine Cuisine â€“ Turkey with Duck Liver Recipe-454g", boxSize: "48*38*28", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD020J", productName: "Premium Canine Cuisine-Lamb with Duck Liver Ricipe-454g", boxSize: "48*38*28", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD040J", productName: "Premium Canine Cuisine-Beef with Duck Liver Ricipe-454g", boxSize: "48*38*28", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD060J", productName: "Premium Canine Cuisine-Chicken with Duck Liver Ricipe-454g", boxSize: "48*38*28", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "GTSL01J", productName: "Gootoe - Turkey Tendon Strip", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTRL05J", productName: "Gootoe - Turkey Tendon Ring_L", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTPL05J", productName: "Gootoe - Turkey Tendon Rope_L", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTBL05J", productName: "Gootoe - Turkey Tendon Bone_L", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTRL01J", productName: "Gootoe - Turkey Tendon Ring_S", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTPL01J", productName: "Gootoe - Turkey Tendon Rope_S", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTBL01J", productName: "Gootoe - Turkey Tendon Bone_S", boxSize: "58.5*34.5*35", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GSF01J", productName: "Gootoe -Turkey Tendon Pumpkin Strip", boxSize: "58.5*34.5*35", perCarton: 150, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTR01J", productName: "Gootoe - Turkey Tendon Ring_S", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTR03J", productName: "Gootoe - Turkey Tendon Ring_M", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTB01J", productName: "Gootoe - Turkey Tendon Bone_S", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTB03J", productName: "Gootoe - Turkey Tendon Bone_M", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTB05J", productName: "Gootoe - Turkey Tendon Bone_L", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTP01J", productName: "Gootoe - Turkey Tendon Rope_S", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTP03J", productName: "Gootoe - Turkey Tendon Rope _M", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTP05J", productName: "Gootoe - Turkey Tendon Rope _L", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTS01J", productName: "Gootoe - Turkey Tendon Strip", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTS03J", productName: "Gootoe - Turkey Tendon Stick_M", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTZ01J", productName: "Gootoe - Turkey Tendon Pretzel_S", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTZ03J", productName: "Gootoe - Turkey Tendon Pretzel_M", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTA01J", productName: "Gootoe - Turkey Tendon Braid", boxSize: "58.5*34.5*35", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "KTB01J", productName: "Natural Turkey Tendon Bone_S", boxSize: "58.5*34.5*35", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "KTB03J", productName: "Natural Turkey Tendon Bone_ M", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "KTB05J", productName: "Natural Turkey Tendon Bone_L", boxSize: "58.5*34.5*35", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "KTB06J", productName: "Natural Turkey Tendon Lollipop", boxSize: "58.5*34.5*35", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "TTR01J", productName: "Natural Turkey Tendon Ring_ S", boxSize: "58.5*34.5*35", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "TTR03J", productName: "Natural Turkey Tendon Ring_ M", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTR05J", productName: "Natural Turkey Tendon Ring_ L", boxSize: "58.5*34.5*35", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "TRP01J", productName: "Natural Turkey Tendon Rope_ S", boxSize: "58.5*34.5*35", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "TRP03J", productName: "Natural Turkey Tendon Rope_ M", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TRP05J", productName: "Natural Turkey Tendon Rope_ L", boxSize: "58.5*34.5*35", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "TTS05J", productName: "Natural Turkey Tendon Strip", boxSize: "58.5*34.5*35", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "TTA01J", productName: "Turkey Tendon Rice Stick", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTA02J", productName: "Turkey Tendon Chicken Stick", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTA03J", productName: "Turkey Tendon Thin Stick", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTA04J", productName: "Turkey Tendon Pumpkin Strip", boxSize: "58.5*34.5*35", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "GRB01AM", productName: "Gootoe - Veal Rib Bone, 85g", boxSize: "48*38*28", perCarton: 130, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "GRB01J", productName: "Gootoe - Veal Rib Bone, 85g", boxSize: "48*38*28", perCarton: 130, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "ART01AM", productName: "Afreschi - Turkey Tendon Wrapped Veal Rib Bone, 85g", boxSize: "48*38*28", perCarton: 130, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "ART01J", productName: "Afreschi - Turkey Tendon Wrapped Veal Rib Bone, 85g", boxSize: "48*38*28", perCarton: 130, perPack: null, perBox: null, perPallet: 21, country: "TW" }
];

    // å¸¸ç”¨ç´™ç®±å°ºå¯¸ => æ£§æ¿æ•¸å°ç…§
    const boxSizePalletMap = {
      "50*40*30": 42,
      "58.5*34.5*35": 36,
      "50*40*40": 30,
      "48*38*28": 36
    };
    let currentCountry = 'VN';

    function showTip(msg, type="info") {
      let tip = document.createElement('div');
      tip.className = 'user-tip ' + type;
      tip.innerText = msg;
      document.body.appendChild(tip);
      setTimeout(()=>{ tip.style.opacity=0; setTimeout(()=>tip.remove(),450); }, 1800);
    }

    function renderDiscontinuedList() {
      const body = document.getElementById('discontinuedListBody');
      if (!body) return;
      const rows = Array.from(discontinuedSkuReasons.entries())
        .map(([sku, reason]) => ({ sku, reason }))
        .sort((a, b) => a.sku.localeCompare(b.sku));
      body.innerHTML = rows.map(row => `
        <tr>
          <td class="discontinued-text">${row.sku}<span class="discontinued-tag">åœç”¢</span></td>
          <td>${row.reason}</td>
        </tr>
      `).join('');
    }

    function getFilteredProducts(){
      if(currentCountry === 'Others'){
        return allProducts.filter(p => p.country !== 'VN' && p.country !== 'TW');
      }
      return allProducts.filter(p => p.country === currentCountry);
    }

    window.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('[name="countrySelect"]').forEach(radio => {
        radio.addEventListener('change', (e) => {
          currentCountry = e.target.value;
          reloadData();
        });
      });
      reloadData();
      packagingTypeChanged();
      boxSizeChanged();
    });

    function reloadData(){
      document.getElementById('searchInput').value = '';
      document.getElementById('searchResults').innerHTML = '';
      document.getElementById('searchResults').style.display = 'none';
      clearTable();
      updateTotals();
      if (window.refreshGeneratorSpeedMetrics) {
        window.refreshGeneratorSpeedMetrics();
      }
    }
    function clearTable(){
      document.querySelector('#productTable tbody').innerHTML = '';
    }

    function getSpeedForProduct(code) {
      if (!window.orderSpeedMap) return null;
      return window.orderSpeedMap.get(code) ?? null;
    }

    function getUnitsPerPallet(prod) {
      const perCarton = Number(prod.perCarton ?? 0);
      const perPallet = Number(prod.perPallet ?? 0);
      if (!perCarton || !perPallet) return 0;
      return perCarton * perPallet;
    }

    function formatPalletDays(prod) {
      const speed = getSpeedForProduct(prod.productCode);
      if (!speed || speed <= 0) return 'â€”';
      const unitsPerPallet = getUnitsPerPallet(prod);
      if (!unitsPerPallet) return 'â€”';
      const days = unitsPerPallet / speed;
      if (!Number.isFinite(days)) return 'â€”';
      return `${days.toFixed(1)} å¤©`;
    }

  window.refreshGeneratorSpeedMetrics = function refreshGeneratorSpeedMetrics() {
    document.querySelectorAll('#productTable tbody tr').forEach(row => {
      const code = row.dataset.product;
      const prod = getProductSpecByCode(code);
      if (!prod) return;
      const cell = row.querySelector('.pallet-days');
      if (cell) cell.textContent = formatPalletDays(prod);
      updateEstimatedDays(row, prod);
    });
  };

  function getAvailForProduct(code) {
    if (!window.availMap) return 0;
    return window.availMap.get(code) ?? 0;
  }

  function formatEstimatedDays(prod, quantity, units) {
    const speed = getSpeedForProduct(prod.productCode);
    if (!speed || speed <= 0) return 'â€”';
    const baseAvail = getAvailForProduct(prod.productCode);
    const addUnits = Number.isFinite(units) && units > 0 ? units : (Number(quantity) || 0);
    const total = baseAvail + addUnits;
    if (!Number.isFinite(total)) return 'â€”';
    const days = total / speed;
    if (!Number.isFinite(days)) return 'â€”';
    return `${days.toFixed(1)} å¤©`;
  }

  function updateEstimatedDays(row, prod) {
    const cell = row.querySelector('.estimated-days');
    if (!cell) return;
    const quantity = parseFloat(row.querySelector('.edit-quantity-input')?.value) || 0;
    const packOrBox = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
    const units = packOrBox ? (parseFloat(packOrBox.value) || 0) : 0;
    cell.textContent = formatEstimatedDays(prod, quantity, units);
  }

  // æœå°‹å“è™Ÿ/å¿«é€Ÿæ–°å¢
  function searchProduct(){
      const val = document.getElementById('searchInput').value.trim().toUpperCase();
      const res = document.getElementById('searchResults');
      res.innerHTML = '';
      if(!val){
        res.style.display='none';
        return;
      }
      const matched = getFilteredProducts().filter(p => p.productCode.toUpperCase().includes(val));
      if(matched.length > 0){
        res.style.display='block';
        matched.forEach(prod=>{
          const item = document.createElement('div');
          item.className = 'search-result-item';
          item.textContent = `${prod.productCode} - ${prod.productName}`;
          item.onclick = () => {
            addProduct(prod);
            document.getElementById('searchInput').value = '';
            res.innerHTML = '';
            res.style.display = 'none';
          };
          res.appendChild(item);
        });
      } else {
        res.style.display='none';
      }
    }

    function applySkuRowState(row, code) {
      if (!row) return;
      const discontinued = isDiscontinuedSku(code);
      const hot = isHotSku(code);
      const skuCell = row.cells[1];
      if (skuCell) {
        skuCell.classList.toggle('discontinued-text', discontinued);
        skuCell.classList.toggle('hot-text', hot);
        const hotTag = skuCell.querySelector('.hot-tag');
        if (hot && !hotTag) {
          skuCell.insertAdjacentHTML('beforeend', ' <span class="hot-tag">ç†±éŠ·å“</span>');
        }
        if (!hot && hotTag) {
          hotTag.remove();
        }
        const tag = skuCell.querySelector('.discontinued-tag');
        if (discontinued && !tag) {
          skuCell.insertAdjacentHTML('beforeend', ' <span class="discontinued-tag">åœç”¢</span>');
        }
        if (!discontinued && tag) {
          tag.remove();
        }
      }
    }

    function addProduct(prod, quantity = null){
      const tbody = document.querySelector('#productTable tbody');
      const existingRow = Array.from(tbody.querySelectorAll('tr')).find(r => r.dataset.product === prod.productCode);
      if(existingRow){
        applySkuRowState(existingRow, prod.productCode);
        if (quantity !== null && Number.isFinite(quantity)) {
          const qtyInput = existingRow.querySelector('.edit-quantity-input');
          if (qtyInput) {
            qtyInput.value = quantity.toFixed(0);
            updateFields(qtyInput, prod.productCode);
          }
          showTip('å·²æ›´æ–°ç”¢å“æ•¸é‡', 'success');
        } else {
          showTip('è©²ç”¢å“å·²åœ¨åˆ—è¡¨', 'error');
        }
        return existingRow;
      }
      const rowIndex = tbody.children.length + 1;
      const {hasPack, hasBox} = checkPackageType(prod);
      let packOrBoxInput = '-';
      if(hasPack){
        packOrBoxInput = `<input type="number" class="edit-pack-input" placeholder="è¢‹æ•¸" oninput="updateFields(this,'${prod.productCode}')">`;
      } else if(hasBox){
        packOrBoxInput = `<input type="number" class="edit-box-input" placeholder="ç›’æ•¸" oninput="updateFields(this,'${prod.productCode}')">`;
      }
      const targetPlaceholder = hasPack ? 'ç›®æ¨™è¢‹æ•¸' : (hasBox ? 'ç›®æ¨™ç›’æ•¸' : 'ç›®æ¨™åŒ…æ•¸');
      const rowHTML = `
      <tr data-product="${prod.productCode}">
        <td>${rowIndex}</td>
        <td>${prod.productCode}</td>
        <td><input type="number" class="edit-quantity-input" placeholder="åŒ…æ•¸" oninput="updateFields(this,'${prod.productCode}')"></td>
        <td>${packOrBoxInput}</td>
        <td><input type="number" class="target-input" placeholder="${targetPlaceholder}" oninput="checkTarget(this)"></td>
        <td><input type="number" class="edit-cartons-input" placeholder="ç®±æ•¸" oninput="updateFields(this,'${prod.productCode}')"></td>
        <td><input type="number" class="edit-pallets-input" placeholder="æ£§æ¿æ•¸" oninput="updateFields(this,'${prod.productCode}')"></td>
        <td>
          <span>${prod.boxSize} cm</span>
        </td>
        <td class="pallet-days">${formatPalletDays(prod)}</td>
        <td class="estimated-days">${formatEstimatedDays(prod, 0, 0)}</td>
        <td class="action-button-group">
          <button type="button" class="action-button" onclick="moveUp(this)" title="ä¸Šç§»"><i class="fa-solid fa-arrow-up"></i></button>
          <button type="button" class="action-button" onclick="moveDown(this)" title="ä¸‹ç§»"><i class="fa-solid fa-arrow-down"></i></button>
          <button type="button" class="lock-button" onclick="toggleLock(this)" title="é–å®š/è§£é–"><i class="fa-solid fa-lock"></i></button>
          <button type="button" class="remove-button" onclick="removeRow(this)" title="åˆªé™¤"><i class="fa-solid fa-trash"></i></button>
        </td>
      </tr>`;
      tbody.insertAdjacentHTML('beforeend', rowHTML);
      const newRow = tbody.lastElementChild;
      applySkuRowState(newRow, prod.productCode);
      updateRowNumbers();
      if (quantity !== null && Number.isFinite(quantity)) {
        const qtyInput = newRow.querySelector('.edit-quantity-input');
        if (qtyInput) {
          qtyInput.value = quantity.toFixed(0);
          updateFields(qtyInput, prod.productCode);
        }
      }
      showTip('å·²åŠ å…¥ç”¢å“', 'success');
      return newRow;
    }
    function checkPackageType(prod){
      const hasPack = (typeof prod.perPack !== 'undefined' && prod.perPack > 0);
      const hasBox = (typeof prod.perBox !== 'undefined' && prod.perBox > 0 && !hasPack);
      return {hasPack, hasBox};
    }
    function getProductSpecByCode(code){
      return allProducts.find(p => p.productCode === code) || null;
    }
    function updateFields(input, productCode){
      const row = input.closest('tr');
      const prod = getProductSpecByCode(productCode);
      if(!prod) return;
      let {quantity, units, cartons, pallets} = getCurrentValues(row);
      const {perPack=0, perBox=0, perCarton=1, perPallet=1} = prod;
      const changedField = getChangedField(input);
      ({quantity, units, cartons, pallets} = recalcValues(changedField, {quantity, units, cartons, pallets, perPack, perBox, perCarton, perPallet}));
      if(changedField !== 'quantity' && row.querySelector('.edit-quantity-input')){
        row.querySelector('.edit-quantity-input').value = quantity.toFixed(0);
      }
      const packInput = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
      if(packInput && changedField !== 'units'){
        packInput.value = units.toFixed(2);
      }
      if(changedField !== 'cartons' && row.querySelector('.edit-cartons-input')){
        row.querySelector('.edit-cartons-input').value = cartons.toFixed(2);
      }
      if(changedField !== 'pallets' && row.querySelector('.edit-pallets-input')){
        row.querySelector('.edit-pallets-input').value = pallets.toFixed(2);
      }
      const target = row.querySelector('.target-input');
      if(target) checkTarget(target);
      updateEstimatedDays(row, prod);
      updateTotals();
    }
    function getChangedField(input){
      if(input.classList.contains('edit-quantity-input')) return 'quantity';
      if(input.classList.contains('edit-pack-input') || input.classList.contains('edit-box-input')) return 'units';
      if(input.classList.contains('edit-cartons-input')) return 'cartons';
      if(input.classList.contains('edit-pallets-input')) return 'pallets';
      return '';
    }
    function getCurrentValues(row){
      const quantity = parseFloat(row.querySelector('.edit-quantity-input')?.value) || 0;
      let units = 0;
      const packOrBox = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
      if(packOrBox){
        units = parseFloat(packOrBox.value) || 0;
      }
      const cartons = parseFloat(row.querySelector('.edit-cartons-input')?.value) || 0;
      const pallets = parseFloat(row.querySelector('.edit-pallets-input')?.value) || 0;
      return {quantity, units, cartons, pallets};
    }
    function recalcValues(changedField, vals){
      let {quantity, units, cartons, pallets, perPack, perBox, perCarton, perPallet} = vals;
      const isBag = (perPack > 0);
      const isBox = (perBox > 0 && !isBag);
      const isSingle = (!isBag && !isBox);
      if(isBag){
        switch(changedField){
          case 'quantity': units = quantity / perPack; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'units': quantity = units * perPack; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'cartons': units = cartons * perCarton; quantity = units * perPack; pallets = cartons / perPallet; break;
          case 'pallets': cartons = pallets * perPallet; units = cartons * perCarton; quantity = units * perPack; break;
        }
      }
      else if(isBox){
        switch(changedField){
          case 'quantity': units = quantity / perBox; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'units': quantity = units * perBox; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'cartons': units = cartons * perCarton; quantity = units * perBox; pallets = cartons / perPallet; break;
          case 'pallets': cartons = pallets * perPallet; units = cartons * perCarton; quantity = units * perBox; break;
        }
      }
      else if(isSingle){
        switch(changedField){
          case 'quantity': cartons = quantity / perCarton; pallets = cartons / perPallet; break;
          case 'cartons': quantity = cartons * perCarton; pallets = cartons / perPallet; break;
          case 'pallets': cartons = pallets * perPallet; quantity = cartons * perCarton; break;
        }
      }
      return {quantity, units, cartons, pallets};
    }
    function checkTarget(targetInput){
      const row = targetInput.closest('tr');
      let currentVal = 0;
      const packOrBox = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
      if(packOrBox){
        currentVal = parseFloat(packOrBox.value) || 0;
      } else {
        currentVal = parseFloat(row.querySelector('.edit-quantity-input').value) || 0;
      }
      const tVal = parseFloat(targetInput.value) || 0;
      if(tVal > 0 && currentVal >= tVal){
        targetInput.style.backgroundColor = '#23c87d';
        targetInput.style.color = '#fff';
      } else if (tVal > 0) {
        targetInput.style.backgroundColor = '#fa5353';
        targetInput.style.color = '#fff';
      } else {
        targetInput.style.backgroundColor = '';
        targetInput.style.color = '';
      }
    }
    function toggleLock(btn){
      const row = btn.closest('tr');
      const isLocked = row.classList.contains('locked');
      row.querySelectorAll('input').forEach(inp => inp.disabled = !isLocked);
      row.classList.toggle('locked', !isLocked);
      btn.innerHTML = isLocked ? '<i class="fa-solid fa-lock"></i>' : '<i class="fa-solid fa-lock-open"></i>';
      showTip(isLocked ? 'å·²è§£é–æ­¤åˆ—' : 'å·²é–å®šæ­¤åˆ—', isLocked ? 'success' : 'info');
    }
    function removeRow(btn){
      btn.closest('tr').remove();
      updateRowNumbers();
      updateTotals();
      showTip('å·²åˆªé™¤ç”¢å“', 'success');
    }
    function moveUp(btn){
      const tr = btn.closest('tr');
      const prev = tr.previousElementSibling;
      if(prev) tr.parentNode.insertBefore(tr, prev);
      updateRowNumbers();
    }
    function moveDown(btn){
      const tr = btn.closest('tr');
      const next = tr.nextElementSibling;
      if(next) tr.parentNode.insertBefore(next, tr);
      updateRowNumbers();
    }
    function updateRowNumbers(){
      const rows = document.querySelectorAll('#productTable tbody tr');
      rows.forEach((r, i) => { r.cells[0].textContent = i + 1; });
    }
    function updateTotals(){
      let totalQuantity = 0, totalCartons = 0, totalPallets = 0;
      const palletCounts = {};
      document.querySelectorAll('.edit-quantity-input').forEach(i => {
        totalQuantity += parseFloat(i.value) || 0;
      });
      document.querySelectorAll('.edit-cartons-input').forEach(i => {
        totalCartons += parseFloat(i.value) || 0;
      });
      const rows = document.querySelectorAll('#productTable tbody tr');
      rows.forEach(row => {
        const pVal = parseFloat(row.querySelector('.edit-pallets-input').value) || 0;
        const boxSize = row.cells[7].textContent.replace(" cm", "").trim();
        if (boxSize) palletCounts[boxSize] = (palletCounts[boxSize] || 0) + pVal;
      });
      totalPallets = Object.values(palletCounts).reduce((a, b) => a + b, 0);
      document.getElementById('totalQuantity').textContent = totalQuantity.toFixed(0);
      document.getElementById('totalCartons').textContent = totalCartons.toFixed(2);
      document.getElementById('totalPallets').textContent = totalPallets.toFixed(2);

      // å‹•æ…‹ç”¢ç”Ÿå„å°ºå¯¸æ£§æ¿çµ±è¨ˆ
      let palletText = '';
      Object.entries(palletCounts).forEach(([size, cnt]) => {
        palletText += `<span style="font-weight:bold;">${size}cm</span>: <span>${cnt.toFixed(2)}</span> `;
      });
      document.getElementById('boxCounts').innerHTML = palletText;

      updateContainerInfo(totalPallets);
    }
    function updateContainerInfo(totalPallets){
      const infoDiv = document.getElementById('containerInfo');
      infoDiv.innerHTML = '';
      let remaining = totalPallets;
      let containerCount = 1;
      while(remaining > 0){
        let type, cap;
        if(remaining <= 10){
          type = '20 å°ºè²¨æ«ƒ';
          cap = 10;
        } else {
          type = '40 å°ºè²¨æ«ƒ';
          cap = 20;
        }
        let use = Math.min(remaining, cap);
        let fillRate = (use/cap)*100;
        let cDiv = document.createElement('div');
        cDiv.innerHTML = `<strong style="font-size:1.05rem;">è²¨æ«ƒ ${containerCount}ï¼š${type}ï¼ˆ${fillRate.toFixed(0)}%ï¼‰</strong>`;
        let pc = document.createElement('div');
        pc.className = 'progress-container';
        let pb = document.createElement('div');
        pb.className = 'progress-bar';
        pb.style.width = fillRate + '%';
        pb.textContent = `${use} / ${cap} æ£§æ¿`;
        pc.appendChild(pb);
        cDiv.appendChild(pc);
        infoDiv.appendChild(cDiv);
        remaining -= use;
        containerCount++;
      }
    }
    function exportToExcel() {
      const wb = XLSX.utils.book_new();
      const orderSheetData = [];
      const orderHeader = ["åºè™Ÿ","å“è™Ÿ","åç¨±","æ¯ç®±","åŒ…è£é¡å‹","ç®±æ•¸","å–®ä½","æ£§æ¿æ•¸","å–®ä½","ç´™ç®±å°ºå¯¸(cm)"];
      orderSheetData.push(orderHeader);
      const rows = document.querySelectorAll('#productTable tbody tr');
      rows.forEach(row => {
        const idx = row.cells[0].textContent;
        const code = row.cells[1].textContent;
        const prod = allProducts.find(p => p.productCode === code);
        if(!prod) return;
        const name = prod.productName || '';
        const eachCarton = prod.perCarton || 1;
        let pkgType = 'å–®åŒ…';
        if(prod.perPack && prod.perPack > 0) pkgType = 'è¢‹è£';
        else if(prod.perBox && prod.perBox > 0) pkgType = 'ç›’è£';
        const cVal = parseFloat(row.querySelector('.edit-cartons-input')?.value) || 0;
        const pVal = parseFloat(row.querySelector('.edit-pallets-input')?.value) || 0;
        const boxSize = prod.boxSize;
        orderSheetData.push([
          idx, code, name, eachCarton, pkgType, cVal, "ç®±", pVal, "æ£§æ¿", boxSize
        ]);
      });
      const wsOrder = XLSX.utils.aoa_to_sheet(orderSheetData);
      XLSX.utils.book_append_sheet(wb, wsOrder, "è¨‚å–®");
      const detailSheetData = [];
      const detailHeader = ["åºè™Ÿ","å“è™Ÿ","åç¨±","åŒ…æ•¸","è¢‹æ•¸/ç›’æ•¸","ç®±æ•¸","æ£§æ¿æ•¸","ç´™ç®±å°ºå¯¸ (cm)"];
      detailSheetData.push(detailHeader);
      rows.forEach(row => {
        const idx = row.cells[0].textContent;
        const code = row.cells[1].textContent;
        const prod = allProducts.find(p => p.productCode === code);
        if(!prod) return;
        const name = prod.productName || '';
        const quantity = parseFloat(row.querySelector('.edit-quantity-input')?.value) || 0;
        let packOrBoxVal = 'â€”';
        const packOrBoxInput = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
        if (packOrBoxInput) {
          const val = parseFloat(packOrBoxInput.value);
          if (val && !isNaN(val)) packOrBoxVal = val;
        }
        const cartons = parseFloat(row.querySelector('.edit-cartons-input')?.value) || 0;
        const pallets = parseFloat(row.querySelector('.edit-pallets-input')?.value) || 0;
        const boxSize = prod.boxSize;
        detailSheetData.push([
          idx, code, name, quantity, packOrBoxVal, cartons, pallets, boxSize
        ]);
      });
      const wsDetail = XLSX.utils.aoa_to_sheet(detailSheetData);
      XLSX.utils.book_append_sheet(wb, wsDetail, "è©³æƒ…");
      const dateStr = getTodayString();
      XLSX.writeFile(wb, `è¨‚å–®${currentCountry}_${dateStr}.xlsx`);
      showTip("å·²åŒ¯å‡º Excel", "success");
    }
    function getTodayString(){
      const now = new Date();
      let mm = String(now.getMonth() + 1).padStart(2, "0");
      let dd = String(now.getDate()).padStart(2, "0");
      return mm + dd;
    }
    function openModal(){
      document.getElementById('boxSizeModal').style.display = 'block';
    }
    function closeModal(){
      document.getElementById('boxSizeModal').style.display = 'none';
    }
    function openDiscontinuedModal(){
      renderDiscontinuedList();
      document.getElementById('discontinuedModal').style.display = 'block';
    }
    function closeDiscontinuedModal(){
      document.getElementById('discontinuedModal').style.display = 'none';
    }
    window.onclick = (e) => {
      if(e.target === document.getElementById('boxSizeModal')) closeModal();
      if(e.target === document.getElementById('newItemModal')) closeNewItemModal();
      if(e.target === document.getElementById('discontinuedModal')) closeDiscontinuedModal();
    }
    // æ–°å“ç”¢ç”Ÿå™¨
    document.getElementById('newItemGeneratorBtn').addEventListener('click', openNewItemModal);
    document.getElementById('discontinuedListBtn').addEventListener('click', openDiscontinuedModal);
    function openNewItemModal(){
      document.getElementById('newItemModal').style.display = 'block';
    }
    function closeNewItemModal(){
      document.getElementById('newItemModal').style.display = 'none';
    }
    function boxSizeChanged(){
      const select = document.getElementById('newItemBoxSize');
      const customInput = document.getElementById('newItemBoxSizeCustom');
      if (select.value === '') {
        customInput.style.display = '';
      } else {
        customInput.style.display = 'none';
        document.getElementById('newItemPallet').value = boxSizePalletMap[select.value] || '';
      }
    }
    function packagingTypeChanged(){
      const type = document.getElementById('newItemPackagingType').value;
      const container = document.getElementById('packagingFields');
      container.innerHTML = '';
      if(type === 'bag'){
        container.innerHTML +=
          '<label>æ¯ç®±è¢‹æ•¸ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerCartonBag" placeholder="å¿…å¡«"></label>';
        container.innerHTML +=
          '<label>æ¯è¢‹å¹¾å…¥ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerPack" placeholder="å¿…å¡«"></label>';
      } else if(type === 'box'){
        container.innerHTML +=
          '<label>æ¯ç®±ç›’æ•¸ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerCartonBox" placeholder="å¿…å¡«"></label>';
        container.innerHTML +=
          '<label>æ¯ç›’å¹¾å…¥ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerBoxBox" placeholder="å¿…å¡«"></label>';
      } else {
        container.innerHTML +=
          '<label>æ¯ç®±åŒ…æ•¸ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerCartonSingle" placeholder="å¿…å¡«"></label>';
      }
    }
    function addNewItemLine(){
      const code = document.getElementById('newItemCode').value.trim();
      const name = document.getElementById('newItemName').value.trim();
      let boxSize = document.getElementById('newItemBoxSize').value;
      if (boxSize === '') {
        boxSize = document.getElementById('newItemBoxSizeCustom').value.trim();
        if (!boxSize) {
          showTip("è«‹å¡«å¯«ç´™ç®±å°ºå¯¸", "error");
          return;
        }
      }
      const pal = document.getElementById('newItemPallet').value.trim();
      const countryVal = document.getElementById('newItemCountry').value;
      const pkgType = document.getElementById('newItemPackagingType').value;
      if(!code || !name || !pal){
        showTip("è«‹å¡«å®Œæ•´å“è™Ÿ/å“å/æ£§æ¿æ•¸", "error");
        return;
      }
      let itemStr = `{productCode:"${code}", productName:"${name}", boxSize:"${boxSize}", perPallet:${pal}, country:"${countryVal}"`;
      if(pkgType === 'bag'){
        const cBag = document.getElementById('newItemPerCartonBag').value.trim();
        const pack = document.getElementById('newItemPerPack').value.trim();
        if(!cBag || !pack){
          showTip("è¢‹è£éœ€å¡«æ¯ç®±è¢‹æ•¸ã€æ¯è¢‹å¹¾å…¥", "error");
          return;
        }
        itemStr += `, perCarton:${cBag}, perPack:${pack}, perBox:null`;
      } else if(pkgType === 'box'){
        const cBox = document.getElementById('newItemPerCartonBox').value.trim();
        const bBox = document.getElementById('newItemPerBoxBox').value.trim();
        if(!cBox || !bBox){
          showTip("ç›’è£éœ€å¡«æ¯ç®±ç›’æ•¸ã€æ¯ç›’å¹¾å…¥", "error");
          return;
        }
        itemStr += `, perCarton:${cBox}, perBox:${bBox}, perPack:null`;
      } else {
        const single = document.getElementById('newItemPerCartonSingle').value.trim();
        if(!single){
          showTip("å–®åŒ…éœ€å¡«æ¯ç®±åŒ…æ•¸", "error");
          return;
        }
        itemStr += `, perCarton:${single}, perPack:null, perBox:null`;
      }
      itemStr += '},';
      const area = document.getElementById('newItemResult');
      const currVal = area.value.trim();
      area.value = currVal ? (currVal + ' ' + itemStr) : itemStr;
      resetNewItemForm();
      showTip('å·²ç”¢ç”Ÿæ–°å•†å“è³‡è¨Š', 'success');
    }
    function resetNewItemForm(){
      document.getElementById('newItemCode').value = '';
      document.getElementById('newItemName').value = '';
      document.getElementById('newItemBoxSize').value = '50*40*30';
      boxSizeChanged();
      document.getElementById('newItemCountry').value = 'VN';
      document.getElementById('newItemPackagingType').value = 'single';
      packagingTypeChanged();
      document.getElementById('newItemPallet').value = boxSizePalletMap['50*40*30'];
      document.getElementById('newItemBoxSizeCustom').value = '';
    }
    function copyNewItems(){
      const area = document.getElementById('newItemResult');
      if(navigator.clipboard && window.isSecureContext){
        navigator.clipboard.writeText(area.value).then(()=>{
          showTip("å·²è¤‡è£½çµæœ", "success");
        },()=>{
          showTip("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ã€‚", "error");
        });
      } else {
        area.select();
        document.execCommand("copy");
        showTip("å·²è¤‡è£½çµæœ", "success");
      }
    }

    const salesInputEl = document.getElementById('salesInput');
    const btnBuildSalesCharts = document.getElementById('btnBuildSalesCharts');
    const factoryPieEl = document.getElementById('factoryPie');
    const itemPieEl = document.getElementById('itemPie');
    const factoryLegendEl = document.getElementById('factoryLegend');
    const itemLegendEl = document.getElementById('itemLegend');
    const salesSummaryEl = document.getElementById('salesSummary');
    const salesMissingEl = document.getElementById('salesMissing');

    const currencyFormatter = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    const productMap = new Map(allProducts.map(p => [String(p.productCode).trim().toUpperCase(), p]));
    const turkeySkuSet = window.turkeySkuSet || new Set();

    function formatCurrency(value) {
      return `US$${currencyFormatter.format(value)}`;
    }

    function normalizeSalesSku(sku) {
      return String(sku ?? "").trim().toUpperCase();
    }

    function parseAmount(value) {
      if (!value) return null;
      const cleaned = String(value).replace(/US\$/i, '').replace(/,/g, '').replace(/[^\d.-]/g, '');
      const num = Number(cleaned);
      return Number.isFinite(num) ? num : null;
    }

    function parseSalesInput(text) {
      const lines = String(text ?? '').split(/\r?\n/).map(line => line.trim()).filter(Boolean);
      const records = [];
      const missingSkus = new Set();
      lines.forEach(line => {
        if (line.includes('SKU') && line.includes('éŠ·å”®é¡')) return;
        const tabParts = line.split(/\t+/);
        let sku = '';
        let amountRaw = '';
        if (tabParts.length >= 2) {
          sku = tabParts[0];
          amountRaw = tabParts.slice(1).join(' ');
        } else {
          const match = line.match(/^([A-Za-z0-9-]+)\s+US?\$?\s*([\d,]+(?:\.\d+)?)/i);
          if (match) {
            sku = match[1];
            amountRaw = match[2];
          }
        }
        if (!sku) return;
        const amount = parseAmount(amountRaw);
        if (!Number.isFinite(amount)) return;
        const normalizedSku = normalizeSalesSku(sku);
        if (!productMap.has(normalizedSku)) {
          missingSkus.add(normalizedSku);
        }
        records.push({ sku: normalizedSku, amount });
      });
      return { records, missingSkus: Array.from(missingSkus) };
    }

    function isTurkeySku(sku) {
      if (turkeySkuSet.has(sku)) return true;
      const prod = productMap.get(sku);
      return Boolean(prod && /turkey tendon/i.test(prod.productName));
    }

    function renderPieChart(pieEl, legendEl, slices) {
      const total = slices.reduce((sum, slice) => sum + slice.value, 0);
      if (total <= 0) {
        pieEl.style.background = '#f0f3f9';
        legendEl.innerHTML = '<div class="legendRow">å°šç„¡è³‡æ–™</div>';
        return;
      }
      let cumulative = 0;
      const segments = slices.map(slice => {
        const percent = (slice.value / total) * 100;
        const start = cumulative;
        cumulative += percent;
        return `${slice.color} ${start}% ${cumulative}%`;
      });
      pieEl.style.background = `conic-gradient(${segments.join(', ')})`;
      legendEl.innerHTML = slices.map(slice => {
        const percent = total > 0 ? ((slice.value / total) * 100).toFixed(1) : '0.0';
        return `
          <div class="legendRow">
            <span class="legendSwatch" style="background:${slice.color}"></span>
            <span>${slice.label}</span>
            <strong>${formatCurrency(slice.value)}</strong>
            <span>${percent}%</span>
          </div>
        `;
      }).join('');
    }

    function buildSalesCharts() {
      const { records, missingSkus } = parseSalesInput(salesInputEl.value);
      const totals = {
        factory: { TW: 0, VN: 0, unknown: 0 },
        item: { turkey: 0, nonTurkey: 0, unknown: 0 },
        total: 0,
      };
      records.forEach(record => {
        const prod = productMap.get(record.sku);
        if (prod?.country === 'TW') {
          totals.factory.TW += record.amount;
        } else if (prod?.country === 'VN') {
          totals.factory.VN += record.amount;
        } else {
          totals.factory.unknown += record.amount;
        }

        if (isTurkeySku(record.sku)) {
          totals.item.turkey += record.amount;
        } else if (prod) {
          totals.item.nonTurkey += record.amount;
        } else {
          totals.item.unknown += record.amount;
        }

        totals.total += record.amount;
      });

      renderPieChart(factoryPieEl, factoryLegendEl, [
        { label: 'å°ç£å» ', value: totals.factory.TW, color: '#4c8bf5' },
        { label: 'è¶Šå—å» ', value: totals.factory.VN, color: '#63c47a' },
      ]);
      renderPieChart(itemPieEl, itemLegendEl, [
        { label: 'ç«é›ç­‹', value: totals.item.turkey, color: '#f1b94b' },
        { label: 'éç«é›ç­‹', value: totals.item.nonTurkey, color: '#8c9caf' },
      ]);

      const notes = [];
      if (totals.factory.unknown > 0) {
        notes.push(`æœªå°æ‡‰å·¥å» ï¼š${formatCurrency(totals.factory.unknown)}`);
      }
      if (totals.item.unknown > 0) {
        notes.push(`æœªå°æ‡‰å“é …ï¼š${formatCurrency(totals.item.unknown)}`);
      }
      salesSummaryEl.textContent = totals.total > 0
        ? `ç¸½éŠ·å”®é¡ï¼š${formatCurrency(totals.total)}${notes.length ? `ï¼ˆ${notes.join(' / ')}ï¼‰` : ''}`
        : 'å°šæœªåµæ¸¬åˆ°å¯è§£æçš„éŠ·å”®é¡è³‡æ–™ã€‚';

      if (missingSkus.length > 0) {
        salesMissingEl.textContent = `æ‰¾ä¸åˆ°å“é …è³‡æ–™çš„ SKUï¼š${missingSkus.join(', ')}`;
      } else {
        salesMissingEl.textContent = '';
      }
    }

    if (btnBuildSalesCharts) {
      btnBuildSalesCharts.addEventListener('click', buildSalesCharts);
    }
</script>
</body>
</html>
